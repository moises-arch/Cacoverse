{% doc %}
  @prompt
    Create a “Customer Reviews” section.
    
    Layout:
    - Desktop: show 3 review cards per row.
    - Mobile: show 1 review card at a time, horizontally scrollable with finger drag (no arrows or dots).
    - Use scroll-snap so cards snap when swiped.
    - Max width 1200px, centered.
    
    Card design:
    - Rounded card with light shadow and padding.
    - Stars at top, review text in middle, avatar + reviewer name at bottom.
    - Use theme fonts and colors.
    
    Settings:
    - Section title.
    - For each review: stars (1–5), text, avatar image, reviewer name.
    - Controls for card background color, border radius, and spacing.
    
    Implementation notes:
    - Desktop uses CSS grid for 3 columns.
    - Mobile uses overflow-x: auto with scroll-snap.
    - Hide scrollbar but keep it functional.
    - No navigation controls., display only 3 reviews in the desktop
    
    display 1 review in the mobile, in the mobile the user can slide the reviews with the finger.   in the mobile the review card cover the whole space width leaving small bleeds., add font weight option, the reviewer avatar  can be  size adjustable.

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-customer-reviews-{{ ai_gen_id }} {
    max-width: 1450px;
    margin: 0 auto;
    padding: 70px 20px;
    padding-bottom: 100px;
  }

  .ai-customer-reviews__title-{{ ai_gen_id }} {
    text-align: center;
    margin-bottom: 40px;
    font-size: {{ block.settings.title_size }}px;
    font-weight: {{ block.settings.title_font_weight }};
    color: {{ block.settings.title_color }};
  }

  .ai-customer-reviews__container-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: {{ block.settings.card_spacing }}px;
  }

  .ai-customer-reviews__card-{{ ai_gen_id }} {
    background-color: {{ block.settings.card_background }};
    border-radius: {{ block.settings.card_border_radius }}px;
    padding: 24px;
    box-shadow:0 2px 8px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .ai-customer-reviews__stars-{{ ai_gen_id }} {
    display: flex;
    gap: 4px;
  }

  .ai-customer-reviews__star-{{ ai_gen_id }} {
    width: 20px;
    height: 20px;
    color: {{ block.settings.star_color }};
  }

  .ai-customer-reviews__star--empty-{{ ai_gen_id }} {
    color: {{ block.settings.star_empty_color }};
  }

  .ai-customer-reviews__text-{{ ai_gen_id }} {
    flex-grow: 1;
    line-height: 1.5;
    color: {{ block.settings.text_color }};
    font-size: {{ block.settings.text_size }}px;font-weight: {{ block.settings.text_font_weight }};
  }

  .ai-customer-reviews__author-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .ai-customer-reviews__avatar-{{ ai_gen_id }} {
    width: {{ block.settings.avatar_size }}px;
    height: {{ block.settings.avatar_size }}px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
  }

  .ai-customer-reviews__avatar-{{ ai_gen_id }} img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .ai-customer-reviews__avatar-placeholder-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    background-color: #e0e0e0;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #666;
    font-size: {{ block.settings.avatar_size | times: 0.4 }}px;
    font-weight: bold;
  }

  .ai-customer-reviews__name-{{ ai_gen_id }} {
    font-weight: {{ block.settings.name_font_weight }};
    color: {{ block.settings.name_color }};
    font-size: {{ block.settings.name_size }}px;
  }

  @media screen and (max-width: 749px) {
    .ai-customer-reviews-{{ ai_gen_id }} {
      padding: 30px 0;
    }

    .ai-customer-reviews__title-{{ ai_gen_id }} {
      padding: 0 20px;
      margin-bottom: 30px;
    }

    .ai-customer-reviews__container-{{ ai_gen_id }} {
      display: flex;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      gap: 16px;
      padding: 0 20px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .ai-customer-reviews__container-{{ ai_gen_id }}::-webkit-scrollbar {
      display: none;
    }

    .ai-customer-reviews__card-{{ ai_gen_id }} {
      flex: 0 0 calc(100vw - 60px);
      scroll-snap-align: center;
      max-width: 400px;
    }
  }


  @media (max-width: 749px){
  .ai-customer-reviews__title-{{ ai_gen_id }}{
    font-size: clamp(27px, 6.9vw, {{ block.settings.title_size }}px) !important;
  }
  .ai-customer-reviews__text-{{ ai_gen_id }}{
    font-size: clamp(14px, 4.8vw, {{ block.settings.text_size }}px) !important;
    line-height: 1.55; /* un pelín más legible en móvil */
  }
  .ai-customer-reviews__name-{{ ai_gen_id }}{
    font-size: clamp(12px, 3.8vw, {{ block.settings.name_size }}px) !important;
  }
}

@media (max-width: 749px){
  .ai-customer-reviews__card-{{ ai_gen_id }} {
    flex: 0 0 calc(100vw - 80px); /* adds space for shadow bleed */
    margin: 10px 0; /* top & bottom breathing */
  }
}










/* Mobile: 1 card at a time, 14px gap, 20px side gutters, no clipped shadows */
@media (max-width: 749px){
  .ai-customer-reviews__container-{{ ai_gen_id }}{
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-padding-left: 20px;
    gap: 20px;                     /* exact space between cards */
    padding: 0 0 10px 0;           /* remove side padding */
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  .ai-customer-reviews__container-{{ ai_gen_id }}::-webkit-scrollbar { display: none; }

  /* Virtual gutters before & after */
  .ai-customer-reviews__container-{{ ai_gen_id }}::before,
  .ai-customer-reviews__container-{{ ai_gen_id }}::after{
    content: "";
    flex: 0 0 20px;
  }

  /* One full-width card minus gutters */
  .ai-customer-reviews__card-{{ ai_gen_id }}{
    flex: 0 0 calc(100vw - 40px);  /* fits viewport minus 20px + 20px gutters */
    scroll-snap-align: start;
    box-shadow: 0 4px 16px rgba(0,0,0,.08);
    border-radius: 14px;
    margin: 10px 0;                /* top/bottom space */
  }
}



{% endstyle %}
 



<div class="ai-customer-reviews-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  {% if block.settings.section_title != blank %}
    <h2 class="ai-customer-reviews__title-{{ ai_gen_id }}">
      {{ block.settings.section_title }}
    </h2>
  {% endif %}

  <div class="ai-customer-reviews__container-{{ ai_gen_id }}">
    {% for i in (1..3) %}
      {% liquid
        assign review_text_key = 'review_' | append: i | append: '_text'
        assign review_stars_key = 'review_' | append: i | append: '_stars'
        assign review_name_key = 'review_' | append: i | append: '_name'
        assign review_avatar_key = 'review_' | append: i | append: '_avatar'

        assign review_text = block.settings[review_text_key]
        assign review_stars = block.settings[review_stars_key]
        assign review_name = block.settings[review_name_key]
        assign review_avatar = block.settings[review_avatar_key]
      %}

      {% if review_text != blank or review_name != blank %}
        <div class="ai-customer-reviews__card-{{ ai_gen_id }}">
          <div class="ai-customer-reviews__stars-{{ ai_gen_id }}">
            {% for star in (1..5) %}
              <svg
                class="ai-customer-reviews__star-{{ ai_gen_id }} {% if star > review_stars %}ai-customer-reviews__star--empty-{{ ai_gen_id }}{% endif %}"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            {% endfor %}
          </div>

          {% if review_text != blank %}
            <div class="ai-customer-reviews__text-{{ ai_gen_id }}">
              {{ review_text }}
            </div>
          {% endif %}

          <div class="ai-customer-reviews__author-{{ ai_gen_id }}">
            <div class="ai-customer-reviews__avatar-{{ ai_gen_id }}">
              {% if review_avatar %}
                <img
                  src="{{ review_avatar | image_url: width: 120}}"
                  alt="{{ review_name | escape }}"
                  width="120"
                  height="120"
                  loading="lazy"
                >
              {% else %}
                <div class="ai-customer-reviews__avatar-placeholder-{{ ai_gen_id }}">
                  {% if review_name != blank %}
                    {{ review_name | slice: 0 | upcase }}
                  {% else %}
                    ?
                  {% endif %}
                </div>
              {% endif %}
            </div>
            {% if review_name != blank %}
              <div class="ai-customer-reviews__name-{{ ai_gen_id }}">
                {{ review_name }}
              </div>
            {% endif %}
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "Customer reviews",
  "settings": [
    {
      "type": "header",
      "content": "Section"
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Section title",
      "default": "What Our Customers Say"
    },
    {
      "type": "range",
      "id": "title_size",
      "min": 16,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Title size",
      "default": 32
    },
    {
      "type": "select",
      "id": "title_font_weight",
      "label": "Title font weight",
      "options": [
        {
          "value": "300",
          "label": "Light"
        },
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi-bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "600"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Card style"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Card background",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "min": 0,
      "max": 24,
      "step": 2,
      "unit": "px",
      "label": "Card border radius",
      "default": 12
    },
    {
      "type": "range",
      "id": "card_spacing",
      "min": 16,
      "max": 48,
      "step": 4,
      "unit": "px",
      "label": "Card spacing",
      "default": 24
    },
    {
      "type": "header",
      "content": "Avatar"
    },
    {
      "type": "range",
      "id": "avatar_size",
      "min": 24,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Avatar size",
      "default": 40
    },
    {
      "type": "header",
      "content": "Text style"
    },
    {
      "type": "range",
      "id": "text_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Review text size",
      "default": 16
    },
    {
      "type": "select",
      "id": "text_font_weight",
      "label": "Review text font weight",
      "options": [
        {
          "value": "300",
          "label": "Light"
        },
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi-bold"
        }
      ],
      "default": "400"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Review text color",
      "default": "#333333"
    },
    {
      "type": "range",
      "id": "name_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Name size",
      "default": 14
    },
    {
      "type": "select",
      "id": "name_font_weight",
      "label": "Name font weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi-bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "600"
    },
    {
      "type": "color",
      "id": "name_color",
      "label": "Name color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Stars"
    },
    {
      "type": "color",
      "id": "star_color",
      "label": "Star color",
      "default": "#ffd700"
    },
    {
      "type": "color",
      "id": "star_empty_color",
      "label": "Empty star color",
      "default": "#e0e0e0"
    },
    {
      "type": "header",
      "content": "Review 1"
    },
    {
      "type": "range",
      "id": "review_1_stars",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Star rating",
      "default": 5
    },
    {
      "type": "textarea",
      "id": "review_1_text",
      "label": "Review text",
      "default": "Amazing product! Exceeded my expectations in every way. The quality is outstanding and shipping was super fast."
    },
    {
      "type": "text",
      "id": "review_1_name",
      "label": "Reviewer name",
      "default": "Sarah Johnson"
    },
    {
      "type": "image_picker",
      "id": "review_1_avatar",
      "label": "Reviewer avatar"
    },
    {
      "type": "header",
      "content": "Review 2"
    },
    {
      "type": "range",
      "id": "review_2_stars",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Star rating",
      "default": 5
    },
    {
      "type": "textarea",
      "id": "review_2_text",
      "label": "Review text",
      "default": "Great customer service and the product works exactly as described. Highly recommend this to anyone looking for quality."
    },
    {
      "type": "text",
      "id": "review_2_name",
      "label": "Reviewer name",
      "default": "Mike Chen"
    },
    {
      "type": "image_picker",
      "id": "review_2_avatar",
      "label": "Reviewer avatar"
    },
    {
      "type": "header",
      "content": "Review 3"
    },
    {
      "type": "range",
      "id": "review_3_stars",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Star rating",
      "default": 4
    },
    {
      "type": "textarea",
      "id": "review_3_text",
      "label": "Review text",
      "default": "Very satisfied with my purchase. The item arrived quickly and was exactly what I ordered. Will definitely shop here again."
    },
    {
      "type": "text",
      "id": "review_3_name",
      "label": "Reviewer name",
      "default": "Emma Rodriguez"
    },
    {
      "type": "image_picker",
      "id": "review_3_avatar",
      "label": "Reviewer avatar"
    }
  ],
  "presets": [
    {
      "name": "Customer reviews"
    }
  ]
}
{% endschema %}