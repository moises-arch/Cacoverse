{%- comment -%}
  Section: Gradient + Title & Logos (compact name)
  - Gradient or background image (image overrides gradient), optional dark overlay
  - Big editable title (center toggle)
  - 4 logos with selectable hover effects
  - Clears theme white backgrounds so the gradient is visible
{%- endcomment -%}

{%- assign uid = section.id | replace: '_','' | downcase -%}

{%- style -%}
/* Remove theme whites over our gradient */
#logos-hero-{{ uid }} * { background-color: transparent !important; }
#logos-hero-{{ uid }} :is(.card, .content-container, .gradient, .color-background-1, .color-background-2){
  background: transparent !important; box-shadow: none !important;
}

/* Section root */
#logos-hero-{{ uid }}{
  position: relative; isolation: isolate; overflow: hidden;
  min-height: {{ section.settings.min_height }}px;
  display: grid; place-items: center;
  padding: {{ section.settings.padding_vertical }}px 20px;
  text-align: center;
}

/* Background layer */
#logos-hero-{{ uid }}::before{
  content:""; position:absolute; inset:0; z-index:0; pointer-events:none;
  {% if section.settings.background_image != blank %}
    background-image: url('{{ section.settings.background_image | image_url: width: 2400 }}');
    background-size: cover; background-position: center; background-repeat: no-repeat;
  {% elsif section.settings.background_gradient != blank %}
    background: {{ section.settings.background_gradient }};
  {% else %}
    background: {{ section.settings.fallback_color }};
  {% endif %}
}

/* Optional dark overlay */
#logos-hero-{{ uid }}::after{
  content:""; position:absolute; inset:0; z-index:0; pointer-events:none;
  background: rgba(0,0,0, {{ section.settings.overlay_opacity | divided_by: 100.0 }});
}

/* Content */
.lh-content-{{ uid }}{ position: relative; z-index: 1; max-width: 1220px; width: 100%; margin: 0 auto; }

/* Title */
.lh-title-{{ uid }}{
  margin: 0 0 {{ section.settings.title_spacing }}px;
  line-height: 1.12; font-weight: 800;
  font-size: {{ section.settings.title_size }}px;
  color: {{ section.settings.title_color }};
  text-align: {% if section.settings.center_title %}center{% else %}left{% endif %};
}

/* Logos */
.lh-logos-{{ uid }}{
  display: flex; flex-wrap: wrap; align-items: center; justify-content: center;
  gap: {{ section.settings.logo_gap }}px; max-width: 1100px; margin: 0 auto;
}
.lh-logo-{{ uid }}{
  width: {{ section.settings.logo_size }}px; height: {{ section.settings.logo_size }}px;
  display: grid; place-items: center; cursor: pointer;
  opacity: 0; transform: translateY(12px);
  will-change: transform, filter, opacity;
}
.lh-logo-inner-{{ uid }}{
  width: 100%; height: 100%; display: grid; place-items: center;
  transition: transform .35s ease, filter .35s ease, box-shadow .35s ease;
}
.lh-logo-{{ uid }} img{ max-width: 100%; max-height: 100%; object-fit: contain; }

/* Hover effects */
.lh-logo-{{ uid }}:hover .lh-logo-inner-{{ uid }}{
  {% case section.settings.hover_effect %}
    {% when 'lift' %}   transform: translateY(-12px);
    {% when 'scale' %}  transform: scale(1.1);
    {% when 'rotate' %} transform: rotate(4deg) scale(1.05);
    {% when 'bounce' %} animation: lh-bounce-{{ uid }} .55s ease;
    {% when 'pulse' %}  animation: lh-pulse-{{ uid }} .55s ease;
    {% when 'glow' %}   filter: drop-shadow(0 10px 28px {{ section.settings.hover_glow_color }}); transform: scale(1.05);
  {% endcase %}
}
@keyframes lh-bounce-{{ uid }}{0%,100%{transform:translateY(0)}30%{transform:translateY(-16px)}60%{transform:translateY(-6px)}}
@keyframes lh-pulse-{{ uid }}{0%,100%{transform:scale(1)}50%{transform:scale(1.12)}}

/* Mobile */
@media (max-width: 749px){
  #logos-hero-{{ uid }}{ padding: {{ section.settings.padding_vertical | times: 0.7 | round }}px 16px; }
  .lh-title-{{ uid }}{ font-size: clamp(24px, 7vw, {{ section.settings.title_size | times: 0.9 }}px); text-align: center; }
  .lh-logo-{{ uid }}{ width: calc({{ section.settings.logo_size }}px * .72); height: calc({{ section.settings.logo_size }}px * .72); }
}
{%- endstyle -%}

<section id="logos-hero-{{ uid }}" {{ section.shopify_attributes }} {% if section.settings.section_aria_label != blank %}aria-label="{{ section.settings.section_aria_label | escape }}"{% endif %}>
  <div class="lh-content-{{ uid }}">
    <h2 class="lh-title-{{ uid }}">
      {{ section.settings.title | default: 'Award-Winning Innovation & Cutting-Edge Technology' }}
    </h2>

    <div class="lh-logos-{{ uid }}">
      {%- for i in (1..4) -%}
        {%- assign key = 'logo_' | append: i -%}
        {%- assign img = section.settings[key] -%}
        <div class="lh-logo-{{ uid }}" data-i="{{ i }}">
          <div class="lh-logo-inner-{{ uid }}">
            {%- if img != blank -%}
              <img
                src="{{ img | image_url: width: 600 }}"
                srcset="{{ img | image_url: width: 240 }} 240w, {{ img | image_url: width: 360 }} 360w, {{ img | image_url: width: 480 }} 480w, {{ img | image_url: width: 600 }} 600w"
                sizes="(max-width: 749px) 35vw, 140px"
                alt="{{ img.alt | default: 'Logo ' | append: i | escape }}"
                loading="lazy"
                width="{{ section.settings.logo_size }}" height="{{ section.settings.logo_size }}">
            {%- else -%}
              {{ 'image' | placeholder_svg_tag }}
            {%- endif -%}
          </div>
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

<script>
(() => {
  const root = document.getElementById('logos-hero-{{ uid }}');
  if (!root) return;
  const items = root.querySelectorAll('.lh-logo-{{ uid }}');
  const duration = {{ section.settings.reveal_duration }};
  const stagger  = {{ section.settings.reveal_stagger }};

  const reveal = () => {
    items.forEach((el, i) => {
      setTimeout(() => {
        el.style.transition = `opacity ${duration}s ease, transform ${duration}s ease`;
        el.style.opacity = '1';
        el.style.transform = 'translateY(0)';
      }, i * stagger);
    });
  };

  const io = new IntersectionObserver((entries) => {
    entries.forEach(e => { if (e.isIntersecting) { reveal(); io.disconnect(); } });
  }, { threshold: 0.2 });
  io.observe(root);
})();
</script>

{% schema %}
{
  "name": "Gradient Logos",
  "settings": [
    { "type": "range", "id": "min_height", "min": 300, "max": 800, "step": 20, "unit": "px", "label": "Min height", "default": 520 },
    { "type": "range", "id": "padding_vertical", "min": 20, "max": 160, "step": 10, "unit": "px", "label": "Vertical padding", "default": 80 },

    { "type": "header", "content": "Background" },
    { "type": "color_background", "id": "background_gradient", "label": "Gradient (theme picker)" },
    { "type": "image_picker", "id": "background_image", "label": "Background image (overrides gradient)" },
    { "type": "color", "id": "fallback_color", "label": "Fallback solid color", "default": "#ffffff" },
    { "type": "range", "id": "overlay_opacity", "min": 0, "max": 80, "step": 5, "unit": "%", "label": "Dark overlay opacity", "default": 0 },

    { "type": "header", "content": "Title" },
    { "type": "text", "id": "title", "label": "Title", "default": "Award-Winning Innovation & Cutting-Edge Technology" },
    { "type": "range", "id": "title_size", "min": 24, "max": 96, "step": 2, "unit": "px", "label": "Title size", "default": 56 },
    { "type": "color", "id": "title_color", "label": "Title color", "default": "#ffffff" },
    { "type": "checkbox", "id": "center_title", "label": "Center title", "default": true },
    { "type": "range", "id": "title_spacing", "min": 8, "max": 120, "step": 4, "unit": "px", "label": "Spacing below title", "default": 36 },

    { "type": "header", "content": "Logos" },
    { "type": "image_picker", "id": "logo_1", "label": "Logo 1" },
    { "type": "image_picker", "id": "logo_2", "label": "Logo 2" },
    { "type": "image_picker", "id": "logo_3", "label": "Logo 3" },
    { "type": "image_picker", "id": "logo_4", "label": "Logo 4" },
    { "type": "range", "id": "logo_size", "min": 60, "max": 220, "step": 10, "unit": "px", "label": "Logo size", "default": 120 },
    { "type": "range", "id": "logo_gap", "min": 10, "max": 100, "step": 5, "unit": "px", "label": "Gap between logos", "default": 40 },

    { "type": "header", "content": "Logo hover" },
    { "type": "select", "id": "hover_effect", "label": "Logo hover effect", "options": [
      { "value": "lift", "label": "Lift" },
      { "value": "scale", "label": "Scale" },
      { "value": "rotate", "label": "Rotate" },
      { "value": "bounce", "label": "Bounce" },
      { "value": "pulse", "label": "Pulse" },
      { "value": "glow", "label": "Glow" }
    ], "default": "lift" },
    { "type": "color", "id": "hover_glow_color", "label": "Glow color", "default": "#334fb4" },

    { "type": "header", "content": "Reveal animation" },
    { "type": "range", "id": "reveal_duration", "min": 0.2, "max": 2, "step": 0.1, "unit": "s", "label": "Fade/slide duration", "default": 0.8 },
    { "type": "range", "id": "reveal_stagger", "min": 0, "max": 500, "step": 50, "unit": "ms", "label": "Delay between logos", "default": 100 },

    { "type": "text", "id": "section_aria_label", "label": "ARIA label (accessibility)", "default": "Awards & technology logos" }
  ],
  "presets": [
    { "name": "Gradient Logos" }
  ]
}
{% endschema %}
