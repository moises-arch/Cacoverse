{% comment %}
Hero section (stable, anti-jump)
{% endcomment %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-hero-{{ ai_gen_id }} {
    position: relative;
    min-height: {{ block.settings.section_height }}px;
    display: flex;
    align-items: center;
    overflow: hidden;
    padding-bottom: 30px;
    /* Fondo: compone gradiente + imagen si ambos existen */
    {% if block.settings.background_gradient != blank and block.settings.background_image %}
      background:
        {{ block.settings.background_gradient }},
        url('{{ block.settings.background_image | image_url: width: 1920 }}') center/cover no-repeat;
    {% elsif block.settings.background_gradient != blank %}
      background: {{ block.settings.background_gradient }};
    {% elsif block.settings.background_image %}
      background: url('{{ block.settings.background_image | image_url: width: 1920 }}') center/cover no-repeat;
    {% else %}
      background-color: {{ block.settings.background_color }};
    {% endif %}
  }

  .ai-hero-{{ ai_gen_id }}::before {
    content: '';
    position: absolute; inset: 0;
    background-color: rgba(0, 0, 0, {{ block.settings.overlay_opacity | divided_by: 100.0 }});
    z-index: 1;
  }

  .ai-hero-container-{{ ai_gen_id }} {
    width: 100%;
    max-width: 1300px;
    margin: 0 auto;
    padding: 5px 10px;
    display: grid;
    grid-template-columns: {% if block.settings.layout == 'text_center' %}1fr{% else %}1fr 1fr{% endif %};
    gap: 60px;
    align-items: center;
    position: relative;
    z-index: 2;
  }

  .ai-hero-content-{{ ai_gen_id }} {
    {% if block.settings.layout == 'text_center' %}
      text-align: center;
      grid-column: 1 / -1;
    {% elsif block.settings.layout == 'text_right' %}
      order: 2;
    {% endif %}
  }

  .ai-hero-image-wrap-{{ ai_gen_id }} {
    position: relative;
    overflow: hidden;
    border-radius: {{ block.settings.image_border_radius }}px;
    {% if block.settings.layout == 'text_center' %}
      display: none;
    {% elsif block.settings.layout == 'text_right' %}
      order: 1;
    {% endif %}
  }

  .ai-hero-img-{{ ai_gen_id }} {
    width: 100%; height: auto;
    border-radius: {{ block.settings.image_border_radius }}px;
    object-fit: cover;
    transition: transform 0.5s ease, filter 0.3s ease;
    will-change: transform, filter;
    cursor: pointer;
  }

  .ai-hero-image-wrap-{{ ai_gen_id }}:hover .ai-hero-img-{{ ai_gen_id }} {
    {% case block.settings.hover_effect %}
      {% when 'zoom' %}        transform: scale(1.1);
      {% when 'zoom_rotate' %} transform: scale(1.1) rotate(2deg);
      {% when 'blur' %}        filter: blur(2px);
      {% when 'brightness' %}  filter: brightness(1.2);
      {% when 'grayscale' %}   filter: grayscale(100%);
      {% when 'lift' %}        transform: translateY(-10px);
    {% endcase %}
  }

  .ai-hero-img-ovl-{{ ai_gen_id }} {
    position: absolute; inset: 0;
    background: linear-gradient(45deg, rgba(51,79,180,.8), rgba(36,40,51,.8));
    opacity: 0; transition: opacity .3s ease;
    display:flex; align-items:center; justify-content:center;
    border-radius: {{ block.settings.image_border_radius }}px;
  }
  .ai-hero-image-wrap-{{ ai_gen_id }}:hover .ai-hero-img-ovl-{{ ai_gen_id }} {
    {% if block.settings.hover_effect == 'overlay' %} opacity: 1; {% endif %}
  }
  .ai-hero-ovl-text-{{ ai_gen_id }} { color:#fff; font-size:18px; font-weight:600; text-align:center; padding:20px; }

  .ai-hero-ph-{{ ai_gen_id }} {
    width: 100%; height: 400px; background:#f4f4f4;
    border-radius: {{ block.settings.image_border_radius }}px;
    display:flex; align-items:center; justify-content:center; position:relative;
    transition: transform .3s ease;
  }
  .ai-hero-ph-{{ ai_gen_id }}:hover { transform: scale(1.02); }
  .ai-hero-ph-{{ ai_gen_id }} svg { width:100%; height:100%; max-width:200px; max-height:200px; opacity:.3; }
  .ai-hero-empty-{{ ai_gen_id }} { position:absolute; bottom:20px; left:50%; transform:translateX(-50%); font-size:14px; color:#666; text-align:center; }

  .ai-hero-eyebrow-{{ ai_gen_id }}{
    font-size: {{ block.settings.eyebrow_size }}px; color: {{ block.settings.eyebrow_color }};
    font-weight:600; text-transform:uppercase; letter-spacing:1px; margin-bottom:16px; display:block;
  }
  .ai-hero-h-{{ ai_gen_id }}{
    font-size: {{ block.settings.heading_size }}px; color: {{ block.settings.heading_color }};
    font-weight:700; line-height:1.2; margin:0 0 24px;
  }
  .ai-hero-sub-{{ ai_gen_id }}{
    font-size: {{ block.settings.subheading_size }}px; color: {{ block.settings.subheading_color }};
    line-height:1.5; margin:0 0 32px; opacity:.9;
  }

  .ai-hero-btns-{{ ai_gen_id }}{
    display:flex; gap:16px; flex-wrap:wrap;
    {% if block.settings.layout == 'text_center' %} justify-content:center; {% endif %}
  }
  .ai-hero-btn-{{ ai_gen_id }}{
    display:inline-flex; align-items:center; justify-content:center;
    padding:16px 32px; font-size:16px; font-weight:600; text-decoration:none;
    border-radius: {{ block.settings.button_border_radius }}px;
    transition: all .3s ease; border:2px solid transparent; min-width:160px;
  }
  .ai-hero-btn--pri-{{ ai_gen_id }}{ background: {{ block.settings.primary_button_bg }}; color: {{ block.settings.primary_button_text_color }}; border-color: {{ block.settings.primary_button_bg }}; }
  .ai-hero-btn--pri-{{ ai_gen_id }}:hover{ background: {{ block.settings.primary_button_hover_bg }}; color: {{ block.settings.primary_button_hover_text }}; border-color: {{ block.settings.primary_button_hover_bg }}; transform: translateY(-2px); }

  .ai-hero-btn--sec-{{ ai_gen_id }}{ background:transparent; color: {{ block.settings.secondary_button_text_color }}; border-color: {{ block.settings.secondary_button_border }}; }
  .ai-hero-btn--sec-{{ ai_gen_id }}:hover{ background: {{ block.settings.secondary_button_hover_bg }}; color: {{ block.settings.secondary_button_hover_text }}; border-color: {{ block.settings.secondary_button_hover_bg }}; transform: translateY(-2px); }

  .ai-hero-feats-{{ ai_gen_id }}{ display:flex; gap:32px; margin-top:40px; flex-wrap:wrap; {% if block.settings.layout == 'text_center' %} justify-content:center; {% endif %} }
  .ai-hero-feat-{{ ai_gen_id }}{ display:flex; align-items:center; gap:8px; font-size:14px; color: {{ block.settings.feature_text_color }}; }
  .ai-hero-feat-ic-{{ ai_gen_id }}{ width:20px; height:20px; color: {{ block.settings.feature_icon_color }}; }

  /* Mobile */
  @media (max-width:768px){
    .ai-hero-container-{{ ai_gen_id }}{ grid-template-columns:1fr; gap:40px; padding:40px 20px; }
    .ai-hero-content-{{ ai_gen_id }}{ text-align:center; order:2; }
    .ai-hero-image-wrap-{{ ai_gen_id }}{ order:1; {% if block.settings.layout == 'text_center' %} display:block; {% endif %} }
    .ai-hero-h-{{ ai_gen_id }}{ font-size: clamp(26px, 7.2vw, {{ block.settings.heading_size | times: 0.95 }}px); margin-bottom:12px; line-height:1.15; }
    .ai-hero-sub-{{ ai_gen_id }}{ font-size: clamp(14px, 4.2vw, {{ block.settings.subheading_size | times: 0.85 }}px); margin-bottom:20px; }

    .ai-hero-btns-{{ ai_gen_id }}{ flex-direction:row; justify-content:center; align-items:stretch; gap:12px; flex-wrap:nowrap; }
    .ai-hero-btn-{{ ai_gen_id }}{ box-sizing:border-box; width:calc(50% - 6px); max-width:none; padding:12px 14px; white-space:nowrap; }

    .ai-hero-feats-{{ ai_gen_id }}{ margin-top:16px; gap:12px 18px; justify-content:center; flex-wrap:wrap; }
    .ai-hero-feat-{{ ai_gen_id }}{ font-size:13px; line-height:1.3; gap:6px; }
    .ai-hero-feat-ic-{{ ai_gen_id }}{ width:16px; height:16px; }
  }

  /* Evita “saltos” por anchors inválidos dentro de este bloque */
  .ai-hero-{{ ai_gen_id }} a[href="#"],
  .ai-hero-{{ ai_gen_id }} a[href="#top"],
  .ai-hero-{{ ai_gen_id }} a:not([href]){ cursor: default; }
{% endstyle %}

<div id="ai-hero-{{ ai_gen_id }}" class="ai-hero-{{ ai_gen_id }}" data-ai-section {{ block.shopify_attributes }}>
  <div class="ai-hero-container-{{ ai_gen_id }}">
    <div class="ai-hero-content-{{ ai_gen_id }}">
      {% if block.settings.eyebrow_text != blank %}
        <span class="ai-hero-eyebrow-{{ ai_gen_id }}">{{ block.settings.eyebrow_text }}</span>
      {% endif %}

      {% if block.settings.heading != blank %}
        <h1 class="ai-hero-h-{{ ai_gen_id }}">{{ block.settings.heading }}</h1>
      {% endif %}

      {% if block.settings.subheading != blank %}
        <div class="ai-hero-sub-{{ ai_gen_id }}">{{ block.settings.subheading }}</div>
      {% endif %}

      <div class="ai-hero-btns-{{ ai_gen_id }}">
        {% if block.settings.primary_btn_text != blank %}
          {% if block.settings.primary_button_link != blank %}
            <a href="{{ block.settings.primary_button_link }}" class="ai-hero-btn-{{ ai_gen_id }} ai-hero-btn--pri-{{ ai_gen_id }}">{{ block.settings.primary_btn_text }}</a>
          {% else %}
            <button class="ai-hero-btn-{{ ai_gen_id }} ai-hero-btn--pri-{{ ai_gen_id }}" type="button" aria-disabled="true">{{ block.settings.primary_btn_text }}</button>
          {% endif %}
        {% endif %}

        {% if block.settings.secondary_btn_text != blank %}
          {% if block.settings.secondary_button_link != blank %}
            <a href="{{ block.settings.secondary_button_link }}" class="ai-hero-btn-{{ ai_gen_id }} ai-hero-btn--sec-{{ ai_gen_id }}">{{ block.settings.secondary_btn_text }}</a>
          {% else %}
            <button class="ai-hero-btn-{{ ai_gen_id }} ai-hero-btn--sec-{{ ai_gen_id }}" type="button" aria-disabled="true">{{ block.settings.secondary_btn_text }}</button>
          {% endif %}
        {% endif %}
      </div>

      {% if block.settings.show_features %}
        <div class="ai-hero-feats-{{ ai_gen_id }}">
          {% if block.settings.feature_1_text != blank %}
            <div class="ai-hero-feat-{{ ai_gen_id }}">
              <svg class="ai-hero-feat-ic-{{ ai_gen_id }}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              {{ block.settings.feature_1_text }}
            </div>
          {% endif %}
          {% if block.settings.feature_2_text != blank %}
            <div class="ai-hero-feat-{{ ai_gen_id }}">
              <svg class="ai-hero-feat-ic-{{ ai_gen_id }}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              {{ block.settings.feature_2_text }}
            </div>
          {% endif %}
          {% if block.settings.feature_3_text != blank %}
            <div class="ai-hero-feat-{{ ai_gen_id }}">
              <svg class="ai-hero-feat-ic-{{ ai_gen_id }}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              {{ block.settings.feature_3_text }}
            </div>
          {% endif %}
        </div>
      {% endif %}
    </div>

    {% if block.settings.layout != 'text_center' %}
      <div class="ai-hero-image-wrap-{{ ai_gen_id }}">
        {% if block.settings.image %}
          <img
            src="{{ block.settings.image | image_url: width: 800 }}"
            alt="{{ block.settings.image.alt | escape }}"
            class="ai-hero-img-{{ ai_gen_id }}"
            loading="lazy"
            draggable="false"
            width="{{ block.settings.image.width }}"
            height="{{ block.settings.image.height }}"
          >
          {% if block.settings.hover_effect == 'overlay' %}
            <div class="ai-hero-img-ovl-{{ ai_gen_id }}">
              <div class="ai-hero-ovl-text-{{ ai_gen_id }}">{{ block.settings.overlay_text | default: 'Discover More' }}</div>
            </div>
          {% endif %}
        {% else %}
          <div class="ai-hero-ph-{{ ai_gen_id }}">
            {{ 'hero-apparel-1' | placeholder_svg_tag }}
            <div class="ai-hero-empty-{{ ai_gen_id }}">Add an image to complete your hero section</div>
          </div>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>

<script>
(function(){
  // Sólo dentro de este bloque
  var root = document.getElementById('ai-hero-{{ ai_gen_id }}');
  if(!root) return;

  // Evita navegación si el href es vacío, '#', '#top' o ancla inexistente.
  root.addEventListener('click', function(e){
    var a = e.target.closest('a');
    if(!a || !root.contains(a)) return;

    var href = (a.getAttribute('href') || '').trim();
    if(!href || href === '#' || href.toLowerCase() === '#top') {
      e.preventDefault(); e.stopPropagation();
      return;
    }
    if(href[0] === '#') {
      var id = href.slice(1);
      if(!id || !document.getElementById(id)){
        e.preventDefault(); e.stopPropagation();
      }
    }
  }, true);
})();
</script>

{% schema %}
{
  "name": "Hero section",
  "settings": [
    { "type": "header", "content": "Layout" },
    { "type": "select", "id": "layout", "label": "Layout", "options": [
        { "value": "text_left", "label": "Text left, image right" },
        { "value": "text_right", "label": "Text right, image left" },
        { "value": "text_center", "label": "Text center, no image" }
      ], "default": "text_left"
    },
    { "type": "range", "id": "section_height", "min": 400, "max": 800, "step": 50, "unit": "px", "label": "Minimum height", "default": 600 },

    { "type": "header", "content": "Background" },
    { "type": "color", "id": "background_color", "label": "Background color", "default": "#ffffff" },
    { "type": "color_background", "id": "background_gradient", "label": "Background gradient" },
    { "type": "image_picker", "id": "background_image", "label": "Background image" },
    { "type": "range", "id": "overlay_opacity", "min": 0, "max": 80, "step": 5, "unit": "%", "label": "Background overlay opacity", "default": 0 },

    { "type": "header", "content": "Hero image" },
    { "type": "image_picker", "id": "image", "label": "Hero image" },
    { "type": "range", "id": "image_border_radius", "min": 0, "max": 40, "step": 4, "unit": "px", "label": "Image border radius", "default": 12 },
    { "type": "select", "id": "hover_effect", "label": "Image hover effect", "options": [
        { "value": "none", "label": "None" },
        { "value": "zoom", "label": "Zoom in" },
        { "value": "zoom_rotate", "label": "Zoom and rotate" },
        { "value": "lift", "label": "Lift with shadow" },
        { "value": "blur", "label": "Blur effect" },
        { "value": "brightness", "label": "Brightness effect" },
        { "value": "grayscale", "label": "Grayscale effect" },
        { "value": "overlay", "label": "Color overlay" }
      ], "default": "zoom"
    },
    { "type": "text", "id": "overlay_text", "label": "Overlay text", "default": "Discover More" },

    { "type": "header", "content": "Content" },
    { "type": "text", "id": "eyebrow_text", "label": "Eyebrow text", "default": "New Collection" },
    { "type": "textarea", "id": "heading", "label": "Heading", "default": "Professional printing solutions for your business" },
    { "type": "textarea", "id": "subheading", "label": "Subheading", "default": "High-quality printing services with fast delivery and competitive prices. Perfect for businesses of all sizes." },

    { "type": "header", "content": "Primary button" },
    { "type": "text", "id": "primary_btn_text", "label": "Button text", "default": "Shop now" },
    { "type": "url", "id": "primary_button_link", "label": "Button link" },

    { "type": "header", "content": "Secondary button" },
    { "type": "text", "id": "secondary_btn_text", "label": "Button text", "default": "Learn more" },
    { "type": "url", "id": "secondary_button_link", "label": "Button link" },

    { "type": "header", "content": "Features" },
    { "type": "checkbox", "id": "show_features", "label": "Show feature list", "default": true },
    { "type": "text", "id": "feature_1_text", "label": "Feature 1", "default": "Free shipping" },
    { "type": "text", "id": "feature_2_text", "label": "Feature 2", "default": "24/7 support" },
    { "type": "text", "id": "feature_3_text", "label": "Feature 3", "default": "Quality guarantee" },

    { "type": "header", "content": "Colors" },
    { "type": "color", "id": "eyebrow_color", "label": "Eyebrow color", "default": "#334fb4" },
    { "type": "color", "id": "heading_color", "label": "Heading color", "default": "#222222" },
    { "type": "color", "id": "subheading_color", "label": "Subheading color", "default": "#666666" },
    { "type": "color", "id": "primary_button_bg", "label": "Primary button background", "default": "#334fb4" },
    { "type": "color", "id": "primary_button_text_color", "label": "Primary button text", "default": "#ffffff" },
    { "type": "color", "id": "primary_button_hover_bg", "label": "Primary button hover background", "default": "#242833" },
    { "type": "color", "id": "primary_button_hover_text", "label": "Primary button hover text", "default": "#ffffff" },
    { "type": "color", "id": "secondary_button_text_color", "label": "Secondary button text", "default": "#334fb4" },
    { "type": "color", "id": "secondary_button_border", "label": "Secondary button border", "default": "#334fb4" },
    { "type": "color", "id": "secondary_button_hover_bg", "label": "Secondary button hover background", "default": "#334fb4" },
    { "type": "color", "id": "secondary_button_hover_text", "label": "Secondary button hover text", "default": "#ffffff" },
    { "type": "color", "id": "feature_text_color", "label": "Feature text color", "default": "#666666" },
    { "type": "color", "id": "feature_icon_color", "label": "Feature icon color", "default": "#334fb4" },

    { "type": "header", "content": "Typography" },
    { "type": "range", "id": "eyebrow_size", "min": 10, "max": 20, "step": 1, "unit": "px", "label": "Eyebrow size", "default": 14 },
    { "type": "range", "id": "heading_size", "min": 24, "max": 80, "step": 4, "unit": "px", "label": "Heading size", "default": 48 },
    { "type": "range", "id": "subheading_size", "min": 14, "max": 24, "step": 1, "unit": "px", "label": "Subheading size", "default": 18 },
    { "type": "range", "id": "button_border_radius", "min": 0, "max": 40, "step": 4, "unit": "px", "label": "Button border radius", "default": 8 }
  ],
  "presets": [{ "name": "Hero section" }]
}
{% endschema %}
