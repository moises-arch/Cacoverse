{% doc %}
  @prompt
    generate a collection page title with breadcrumbs , it should have a heading , sub heading, breadcrumbs, option for background photo, foreground photo at the left, option for gradation background, the background use the collection main photo, create adjustment for category image image background   remove the foreground photo., add to the right or left  the first 3 products of the collection  in an small box with title of the product and price, itÂ´s like features products, in feautured products display randome products of the category, not in order.  and secon photo in hover. 
    
    the gradient background is not working, is always white. , back to the last version, collection link should go to the main category, collection s link can be configurated manually 
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-collection-header-{{ ai_gen_id }} {
    position: relative;
    padding: {{ block.settings.padding_top }}px 0 {{ block.settings.padding_bottom }}px;
    overflow: hidden;
  }

  .ai-collection-header__background-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
  }

  .ai-collection-header__background-image-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    object-fit: {{ block.settings.image_fit }};
    object-position: {{ block.settings.image_position }};
  }

  .ai-collection-header__background-color-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    {% if block.settings.enable_gradient and block.settings.background_gradient != blank %}
      background: {{ block.settings.background_gradient }};
    {% else %}
      background: {{ block.settings.background_color }};
    {% endif %}
  }

  .ai-collection-header__overlay-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, {{ block.settings.overlay_opacity | divided_by: 100.0 }});
  }

  .ai-collection-header__container-{{ ai_gen_id }} {
    position: relative;
    z-index: 1;
    max-width: {{ block.settings.container_width }}px;
    margin: 0 auto;
    padding: 0 20px;
    display: flex;
    align-items: center;
    gap: 40px;
    {% if block.settings.products_position == 'left' %}
      flex-direction: row-reverse;
    {% endif %}
  }

  .ai-collection-header__content-{{ ai_gen_id }} {
    flex: 1;
    min-width: 0;
  }

  .ai-collection-breadcrumbs-{{ ai_gen_id }} {
    margin-bottom: {{ block.settings.breadcrumb_spacing }}px;
  }

  .ai-collection-breadcrumbs__list-{{ ai_gen_id }} {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 8px;
    list-style: none;
    margin: 0;
    padding: 0;
    font-size: {{ block.settings.breadcrumb_font_size }}px;
  }

  .ai-collection-breadcrumbs__item-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .ai-collection-breadcrumbs__link-{{ ai_gen_id }} {
    color: {{ block.settings.breadcrumb_color }};
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .ai-collection-breadcrumbs__link-{{ ai_gen_id }}:hover {
    color: {{ block.settings.breadcrumb_hover_color }};
    text-decoration: underline;
  }

  .ai-collection-breadcrumbs__separator-{{ ai_gen_id }} {
    color: {{ block.settings.breadcrumb_separator_color }};
    user-select: none;
  }

  .ai-collection-breadcrumbs__current-{{ ai_gen_id }} {
    color: {{ block.settings.breadcrumb_current_color }};
  }

  .ai-collection-heading-{{ ai_gen_id }} {
    margin: 0 0 {{ block.settings.heading_spacing }}px;
    font-size: {{ block.settings.heading_font_size }}px;
    color: {{ block.settings.heading_color }};
    font-weight: {{ block.settings.heading_font_weight }};
    line-height: 1.2;
  }

  .ai-collection-subheading-{{ ai_gen_id }} {
    margin: 0;
    font-size: {{ block.settings.subheading_font_size }}px;
    color: {{ block.settings.subheading_color }};
    line-height: 1.5;
  }

  .ai-collection-featured-products-{{ ai_gen_id }} {
    flex-shrink: 0;
    width: {{ block.settings.products_width }}px;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .ai-collection-product-card-{{ ai_gen_id }} {
    background-color: {{ block.settings.card_background }};
    border-radius: {{ block.settings.card_radius }}px;
    padding: 12px;
    display: flex;
    gap: 12px;
    align-items: center;
    text-decoration: none;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .ai-collection-product-card-{{ ai_gen_id }}:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .ai-collection-product-image-{{ ai_gen_id }} {
    width: 80px;
    height: 80px;
    flex-shrink: 0;
    border-radius: {{ block.settings.image_radius }}px;
    overflow: hidden;
    background-color: #f5f5f5;
  }

  .ai-collection-product-image-{{ ai_gen_id }} img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .ai-collection-product-info-{{ ai_gen_id }} {
    flex: 1;
    min-width: 0;
  }

  .ai-collection-product-title-{{ ai_gen_id }} {
    margin: 0 0 4px;
    font-size: {{ block.settings.product_title_size }}px;
    font-weight: 600;
    color: {{ block.settings.card_text_color }};
    line-height: 1.3;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  .ai-collection-product-price-{{ ai_gen_id }} {
    font-size: {{ block.settings.product_price_size }}px;
    color: {{ block.settings.card_price_color }};
    font-weight: 500;
  }

  @media screen and (max-width: 989px) {
    .ai-collection-header__container-{{ ai_gen_id }} {
      flex-direction: column;
    }

    .ai-collection-featured-products-{{ ai_gen_id }} {
      width: 100%;
      max-width: 500px;
    }

    .ai-collection-heading-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.heading_font_size }}px * 0.7);
    }

    .ai-collection-subheading-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.subheading_font_size }}px * 0.9);
    }

    .ai-collection-breadcrumbs__list-{{ ai_gen_id }} {
      font-size: calc({{ block.settings.breadcrumb_font_size }}px * 0.9);
    }
  }

  @media screen and (max-width: 749px) {
    .ai-collection-featured-products-{{ ai_gen_id }} {
      width: 100%;
    }

    .ai-collection-product-image-{{ ai_gen_id }} {
      width: 60px;
      height: 60px;
    }
  }
{% endstyle %}

<div class="ai-collection-header-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-collection-header__background-{{ ai_gen_id }}">
    {% if block.settings.use_collection_image and collection.image %}
      <img
        src="{{ collection.image | image_url: width: 2000 }}"
        alt="{{ collection.image.alt | escape }}"
        loading="lazy"
        width="{{ collection.image.width }}"
        height="{{ collection.image.height }}"
        class="ai-collection-header__background-image-{{ ai_gen_id }}"
      >
    {% elsif block.settings.background_image %}
      <img
        src="{{ block.settings.background_image | image_url: width: 2000 }}"
        alt="{{ block.settings.background_image.alt | escape }}"
        loading="lazy"
        width="{{ block.settings.background_image.width }}"
        height="{{ block.settings.background_image.height }}"
        class="ai-collection-header__background-image-{{ ai_gen_id }}"
      >
    {% endif %}
    <div class="ai-collection-header__background-color-{{ ai_gen_id }}"></div>
    {% if block.settings.enable_overlay %}
      <div class="ai-collection-header__overlay-{{ ai_gen_id }}"></div>
    {% endif %}
  </div>

  <div class="ai-collection-header__container-{{ ai_gen_id }}">
    <div class="ai-collection-header__content-{{ ai_gen_id }}">
      {% if block.settings.show_breadcrumbs %}
        <nav class="ai-collection-breadcrumbs-{{ ai_gen_id }}" aria-label="Breadcrumb">
          <ol class="ai-collection-breadcrumbs__list-{{ ai_gen_id }}">
            <li class="ai-collection-breadcrumbs__item-{{ ai_gen_id }}">
              <a href="/" class="ai-collection-breadcrumbs__link-{{ ai_gen_id }}">
                {{ block.settings.home_text }}
              </a>
              <span class="ai-collection-breadcrumbs__separator-{{ ai_gen_id }}" aria-hidden="true">
                {{ block.settings.separator }}
              </span>
            </li>
            {% if block.settings.show_collections_link %}
              <li class="ai-collection-breadcrumbs__item-{{ ai_gen_id }}">
                <a href="{% if block.settings.collections_link != blank %}{{ block.settings.collections_link }}{% else %}/collections{% endif %}" class="ai-collection-breadcrumbs__link-{{ ai_gen_id }}">
                  {{ block.settings.collections_text }}
                </a>
                <span class="ai-collection-breadcrumbs__separator-{{ ai_gen_id }}" aria-hidden="true">
                  {{ block.settings.separator }}
                </span>
              </li>
            {% endif %}
            <li class="ai-collection-breadcrumbs__item-{{ ai_gen_id }}">
              <span class="ai-collection-breadcrumbs__current-{{ ai_gen_id }}" aria-current="page">
                {{ collection.title }}
              </span>
            </li>
          </ol>
        </nav>
      {% endif %}

      <h1 class="ai-collection-heading-{{ ai_gen_id }}">
        {% if block.settings.custom_heading != blank %}
          {{ block.settings.custom_heading }}
        {% else %}
          {{ collection.title }}
        {% endif %}
      </h1>

      {% if block.settings.show_subheading %}
        <div class="ai-collection-subheading-{{ ai_gen_id }}">
          {% if block.settings.custom_subheading != blank %}
            {{ block.settings.custom_subheading }}
          {% elsif collection.description != blank %}
            {{ collection.description }}
          {% endif %}
        </div>
      {% endif %}
    </div>

    {% if block.settings.show_featured_products %}
      <div class="ai-collection-featured-products-{{ ai_gen_id }}">
        {% for product in collection.products limit: 3 %}
          <a href="{{ product.url }}" class="ai-collection-product-card-{{ ai_gen_id }}">
            <div class="ai-collection-product-image-{{ ai_gen_id }}">
              {% if product.featured_image %}
                <img
                  src="{{ product.featured_image | image_url: width: 200 }}"
                  alt="{{ product.featured_image.alt | escape }}"
                  loading="lazy"
                  width="200"
                  height="200"
                >
              {% else %}
                {{ 'product-1' | placeholder_svg_tag }}
              {% endif %}
            </div>
            <div class="ai-collection-product-info-{{ ai_gen_id }}">
              <h3 class="ai-collection-product-title-{{ ai_gen_id }}">
                {{ product.title }}
              </h3>
              <div class="ai-collection-product-price-{{ ai_gen_id }}">
                {{ product.price | money }}
              </div>
            </div>
          </a>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</div>

{% schema %}
{
  "name": "Collection header",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Heading"
    },
    {
      "type": "text",
      "id": "custom_heading",
      "label": "Custom heading",
      "info": "Leave blank to use collection title"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "min": 24,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Font size",
      "default": 56
    },
    {
      "type": "select",
      "id": "heading_font_weight",
      "label": "Font weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi-bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "700"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "heading_spacing",
      "min": 0,
      "max": 40,
      "step": 4,
      "unit": "px",
      "label": "Spacing below",
      "default": 16
    },
    {
      "type": "header",
      "content": "Subheading"
    },
    {
      "type": "checkbox",
      "id": "show_subheading",
      "label": "Show subheading",
      "default": true
    },
    {
      "type": "textarea",
      "id": "custom_subheading",
      "label": "Custom subheading",
      "info": "Leave blank to use collection description"
    },
    {
      "type": "range",
      "id": "subheading_font_size",
      "min": 12,
      "max": 32,
      "step": 1,
      "unit": "px",
      "label": "Font size",
      "default": 18
    },
    {
      "type": "color",
      "id": "subheading_color",
      "label": "Color",
      "default": "#e0e0e0"
    },
    {
      "type": "header",
      "content": "Breadcrumbs"
    },
    {
      "type": "checkbox",
      "id": "show_breadcrumbs",
      "label": "Show breadcrumbs",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_collections_link",
      "label": "Show collections link",
      "default": true
    },
    {
      "type": "text",
      "id": "home_text",
      "label": "Home text",
      "default": "Home"
    },
    {
      "type": "text",
      "id": "collections_text",
      "label": "Collections text",
      "default": "Collections"
    },
    {
      "type": "url",
      "id": "collections_link",
      "label": "Collections link",
      "info": "Leave blank to use /collections"
    },
    {
      "type": "text",
      "id": "separator",
      "label": "Separator",
      "default": "/"
    },
    {
      "type": "range",
      "id": "breadcrumb_font_size",
      "min": 10,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Font size",
      "default": 14
    },
    {
      "type": "range",
      "id": "breadcrumb_spacing",
      "min": 0,
      "max": 40,
      "step": 4,
      "unit": "px",
      "label": "Spacing below",
      "default": 12
    },
    {
      "type": "color",
      "id": "breadcrumb_color",
      "label": "Link color",
      "default": "#cccccc"
    },
    {
      "type": "color",
      "id": "breadcrumb_hover_color",
      "label": "Link hover color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "breadcrumb_separator_color",
      "label": "Separator color",
      "default": "#999999"
    },
    {
      "type": "color",
      "id": "breadcrumb_current_color",
      "label": "Current page color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Featured products"
    },
    {
      "type": "checkbox",
      "id": "show_featured_products",
      "label": "Show featured products",
      "default": true,
      "info": "Displays the first 3 products from the collection"
    },
    {
      "type": "select",
      "id": "products_position",
      "label": "Position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "right"
    },
    {
      "type": "range",
      "id": "products_width",
      "min": 200,
      "max": 400,
      "step": 20,
      "unit": "px",
      "label": "Width",
      "default": 300
    },
    {
      "type": "range",
      "id": "product_title_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Title size",
      "default": 14
    },
    {
      "type": "range",
      "id": "product_price_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Price size",
      "default": 14
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Card background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "card_text_color",
      "label": "Card text color",
      "default": "#222222"
    },
    {
      "type": "color",
      "id": "card_price_color",
      "label": "Card price color",
      "default": "#666666"
    },
    {
      "type": "range",
      "id": "card_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Card border radius",
      "default": 8
    },
    {
      "type": "range",
      "id": "image_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Image border radius",
      "default": 4
    },
    {
      "type": "header",
      "content": "Background image"
    },
    {
      "type": "checkbox",
      "id": "use_collection_image",
      "label": "Use collection image",
      "default": true,
      "info": "Uses the collection's featured image as background"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Fallback background image",
      "info": "Used when collection has no image or option above is disabled"
    },
    {
      "type": "select",
      "id": "image_fit",
      "label": "Image fit",
      "options": [
        {
          "value": "cover",
          "label": "Cover"
        },
        {
          "value": "contain",
          "label": "Contain"
        },
        {
          "value": "fill",
          "label": "Fill"
        }
      ],
      "default": "cover"
    },
    {
      "type": "select",
      "id": "image_position",
      "label": "Image position",
      "options": [
        {
          "value": "center center",
          "label": "Center"
        },
        {
          "value": "top center",
          "label": "Top"
        },
        {
          "value": "bottom center",
          "label": "Bottom"
        },
        {
          "value": "center left",
          "label": "Left"
        },
        {
          "value": "center right",
          "label": "Right"
        }
      ],
      "default": "center center"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#242833",
      "info": "Used when no image or gradient is set"
    },
    {
      "type": "checkbox",
      "id": "enable_gradient",
      "label": "Enable gradient",
      "default": false,
      "info": "Gradient will override background color"
    },
    {
      "type": "color_background",
      "id": "background_gradient",
      "label": "Background gradient",
      "info": "Only applies when gradient is enabled"
    },
    {
      "type": "checkbox",
      "id": "enable_overlay",
      "label": "Enable overlay",
      "default": true,
      "info": "Darkens background for better text readability"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "%",
      "label": "Overlay opacity",
      "default": 30
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "container_width",
      "min": 1000,
      "max": 1600,
      "step": 100,
      "unit": "px",
      "label": "Container width",
      "default": 1500
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 20,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 20,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 60
    }
  ],
  "presets": [
    {
      "name": "Collection header"
    }
  ]
}
{% endschema %}
