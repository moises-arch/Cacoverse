{% doc %}
  @prompt
    generate product collection page like this:   https://defendersafety.com/collections/safety-helmets, display allways the current category. 
    
    show filters like in this website: https://www.cacoamerica.com/collections/all
    
    , in filters show categories and subcategories, simple style. 
    
    show products tags
    
    display the second image of the product when hover ( can be turned on and off )
    
    add controls for borders and shadow
     do not display add to cart button 
    
    add swatch colors 
    
    price should be display similar to this style ( From $10.99), add this snipet after title for reviews:  {% render 'junip-product-summary', product: product %}
    
    
    add Description ( have to display this: product.metafields.custom.sub_title ), not full width contain it to 1450px, make it look super good in mobile. , mostrar paginación y opcion de infinite scrolling, se puede activar y desactivar
    
    el sidebar debe de mostrarse completo  no cortado.
    
    las categorias en el sidebar deben estar ordenas por categoria principal y subcategorias. 
    
    añadir opción para cambiar el color de fondo de la sección 
    
    la sección debe medir 1450px maximo 
    
    en mobile debe haber separación en la izquierda y derecha 
    
    añadir controles para espaciado de los cards, mostrar paginas al final. 
    
    , sidebar: sin scroll, debe de mostrarse por completo sin recortarse. 
    
    agrega iconos a el sidebar ( opcion de desacticarlos), utiliza este tipo de iconos para el menu: https://www.shutterstock.com/image-vector/most-common-app-icon-set-260nw-1118409833.jpg
    
    no mostrar icono en subcategorias 
    
    en all products mostrarlo resaltado con icono de menu 
    
    el icono de precio cambia el icono 
    
    el bullet de los elementos de los tag cambialo, use the icons from this website: https://fonts.google.com/icons
    
    add options for change all the icons , back to the  previous icons but keep the option to add icons in svg format. 
    
    , agregar opciones de espaciado en el sidebar, categories, tags, etc 
    
    price range  min y max deben de ser menos anchos 
    
    
    los elementos del sidebar deben de tener la opcion de desplegar y no desplegar,   debe poder elegir si se quiere cada opcion desplegada por default o no. , add space between cards 
    
    show tags filters after title  like the ones in this website ( https://www.cacoamerica.com/collections/hand-protection) add options to control the stye of the tags. 
    
    amount of products and featured should be out of the frame,  add options  for style and icons for featured. , en sidebar mostrar solo las categorias principales. , REPLACE THE FILTER TAGS FOR THIS: 
        <div class="product-types-filter-buttons">
          {% for link in linklists['main-menu'].links %}
            {% assign parent_link_title = link.title | handleize | downcase %}
            {% if parent_link_title == 'products' and link.links.size > 0 %}
              {% for sublink in link.links %}
                {% assign sublink_parts = sublink.url | split: '/' %}
                {% assign sublink_handle = sublink_parts | last %}
                {% if sublink_handle == collection.metafields.custom.parent_collection.value.handle
                  or sublink_handle == collection.handle
                %}
                  <a href="{{ sublink.url }}" class="filter-btn active p-btn"
                    ><span>All {{ sublink.title }}</span></a
                  >
                  {% if sublink.links.size > 0 %}
                    {% for subsublink in sublink.links %}
                      <a href="{{ subsublink.url }}" class="filter-btn p-btn"
                        ><span>{{ subsublink.title }}</span></a
                      >
                    {% endfor %}
                  {% endif %}
                {% endif %}
              {% endfor %}
            {% endif %}
          {% endfor %}
        </div>, option for desactive collection header.
    
    collection meta should be before filter buttons.
    
    product card text should be aligned to the left 
    , el sidebar debe poder ajustarse el ancho.
    
    en el sidebar los titulos deben estar alineados a la izquierda. 
    
    remplaza los iconos de la lista de categorías por bullets y reduce el espacio entre cada uno. 
    
    filter button:  debe estar resaltado el que este seleccionado. 
    
    
    
    , replace the categories in the sidebar with this:   size-filter-ul facets-layout facets-layout-list facets-layout-list--text facets__list--vertical list-unstyled main-category-products, Sidebar adjustments 
    
    Remove sidebar icons — show only text.
    
    Align sidebar text to the left.
    
    Remove bullets from sidebar category lists.
    
    Make collapsible icons much larger (expand/collapse arrows).
    
    Hide all sidebar adjustments on mobile devices
    
    
    Meta information + filter layout
    
    Display Meta info and Filter buttons in the same row.
    
    Filter buttons go on the left, Meta info on the right.
    
    On small screens, make the filter buttons horizontally scrollable (slider-style).
    
    Use pill-shaped buttons for all filters.
    
    Meta info should only include:
    
    Order by
    Results per page, Filter buttons:
    Add visible buttons that let users scroll through the filter options horizontally.
    
    , back to the last version, la  sección no debe ser más ancha de 1450px, force it to be 1450px width in desktop
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-collection-container-{{ ai_gen_id }} {
    width: 1450px;
    margin: 0 auto;
    padding: 0 20px;
    background-color: {{ block.settings.section_background_color }};
    box-sizing: border-box;
  }

  @media screen and (max-width: 1490px) {
    .ai-collection-container-{{ ai_gen_id }} {
      width: calc(100% - 40px);
      max-width: 1450px;
    }
  }

  @media screen and (max-width: 749px) {
    .ai-collection-container-{{ ai_gen_id }} {
      padding: 0 16px;
      width: calc(100% - 32px);
    }
  }

  .ai-collection-header-{{ ai_gen_id }} {
    text-align: center;
    margin-bottom: 40px;
  }

  .ai-collection-title-{{ ai_gen_id }} {
    font-size: 2.5rem;
    margin: 0 0 16px;
    color: {{ block.settings.header_text_color }};
  }

  .ai-collection-description-{{ ai_gen_id }} {
    font-size: 1.1rem;
    color: {{ block.settings.header_text_color }};
    opacity: 0.8;
  }

  .ai-collection-meta-filters-{{ ai_gen_id }} {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    gap: 20px;
  }

  .ai-filter-navigation-{{ ai_gen_id }} {
    flex: 1;
    max-width: 70%;
  }

  .ai-filter-buttons-{{ ai_gen_id }} {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding: 4px 0;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .ai-filter-buttons-{{ ai_gen_id }}::-webkit-scrollbar {
    display: none;
  }

  .ai-filter-btn-{{ ai_gen_id }} {
    background: {{ block.settings.filter_button_bg }};
    color: {{ block.settings.filter_button_text }};
    border: 1px solid {{ block.settings.filter_button_border }};
    padding: 10px 20px;
    border-radius: 25px;
    text-decoration: none;
    white-space: nowrap;
    transition: all 0.3s ease;
    font-size: 14px;
    flex-shrink: 0;
  }

  .ai-filter-btn-{{ ai_gen_id }}:hover,
  .ai-filter-btn-{{ ai_gen_id }}.active {
    background: {{ block.settings.filter_button_hover_bg }};
    color: {{ block.settings.filter_button_hover_text }};
    border-color: {{ block.settings.filter_button_hover_bg }};
  }

  .ai-meta-info-{{ ai_gen_id }} {
    display: flex;
    gap: 15px;
    align-items: center;
  }

  .ai-meta-pill-{{ ai_gen_id }} {
    background: {{ block.settings.meta_pill_bg }};
    border: 1px solid {{ block.settings.meta_pill_border }};
    border-radius: 25px;
    padding: 8px 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    color: {{ block.settings.meta_pill_text }};
  }

  .ai-meta-icon-{{ ai_gen_id }} {
    width: 16px;
    height: 16px;
  }

  .ai-meta-select-{{ ai_gen_id }} {
    background: transparent;
    border: none;
    color: inherit;
    font-size: 14px;
    cursor: pointer;
  }

  .ai-collection-layout-{{ ai_gen_id }} {
    display: flex;
    gap: {{ block.settings.layout_gap }}px;
  }

  .ai-sidebar-{{ ai_gen_id }} {
    width: {{ block.settings.sidebar_width }}px;
    flex-shrink: 0;
  }

  .ai-sidebar-section-{{ ai_gen_id }} {
    margin-bottom: {{ block.settings.sidebar_section_spacing }}px;
    border: 1px solid {{ block.settings.sidebar_border_color }};
    border-radius: {{ block.settings.sidebar_border_radius }}px;
    background: {{ block.settings.sidebar_bg_color }};
    box-shadow: {{ block.settings.sidebar_shadow_h }}px {{ block.settings.sidebar_shadow_v }}px {{ block.settings.sidebar_shadow_blur }}px rgba(0,0,0,{{ block.settings.sidebar_shadow_opacity | divided_by: 100.0 }});
  }

  .ai-sidebar-header-{{ ai_gen_id }} {
    padding: {{ block.settings.sidebar_header_padding }}px;
    border-bottom: 1px solid {{ block.settings.sidebar_border_color }};
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    background: {{ block.settings.sidebar_header_bg }};
  }

  .ai-sidebar-title-{{ ai_gen_id }} {
    font-weight: 600;
    color: {{ block.settings.sidebar_text_color }};
    text-align: left;
    margin: 0;
    font-size: 16px;
  }

  .ai-sidebar-toggle-{{ ai_gen_id }} {
    font-size: 24px;
    color: {{ block.settings.sidebar_text_color }};
    font-weight: bold;
    line-height: 1;
  }

  .ai-sidebar-content-{{ ai_gen_id }} {
    padding: {{ block.settings.sidebar_content_padding }}px;
    display: block;
  }

  .ai-sidebar-content-{{ ai_gen_id }}.collapsed {
    display: none;
  }

  .ai-category-list-{{ ai_gen_id }} {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .ai-category-item-{{ ai_gen_id }} {
    margin-bottom: {{ block.settings.category_item_spacing }}px;
  }

  .ai-category-link-{{ ai_gen_id }} {
    color: {{ block.settings.sidebar_text_color }};
    text-decoration: none;
    display: block;
    padding: 8px 0;
    text-align: left;
    transition: color 0.3s ease;
  }

  .ai-category-link-{{ ai_gen_id }}:hover {
    color: {{ block.settings.sidebar_link_hover_color }};
  }

  .ai-price-inputs-{{ ai_gen_id }} {
    display: flex;
    gap: 10px;
    align-items: center;
  }

  .ai-price-input-{{ ai_gen_id }} {
    width: 80px;
    padding: 8px;
    border: 1px solid {{ block.settings.sidebar_border_color }};
    border-radius: 4px;
    font-size: 14px;
  }

  .ai-tag-list-{{ ai_gen_id }} {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin: 0;
    padding: 0;
    list-style: none;
  }

  .ai-tag-item-{{ ai_gen_id }} {
    background: {{ block.settings.tag_bg_color }};
    color: {{ block.settings.tag_text_color }};
    padding: 6px 12px;
    border-radius: {{ block.settings.tag_border_radius }}px;
    font-size: 12px;
    border: 1px solid {{ block.settings.tag_border_color }};
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .ai-tag-item-{{ ai_gen_id }}:hover {
    background: {{ block.settings.tag_hover_bg }};
    color: {{ block.settings.tag_hover_text }};
  }

  .ai-products-grid-{{ ai_gen_id }} {
    flex: 1;
  }

  .ai-products-container-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat({{ block.settings.products_per_row }}, 1fr);
    gap: {{ block.settings.card_spacing }}px;
    margin-bottom: 40px;
  }

  .ai-product-card-{{ ai_gen_id }} {
    border: {{ block.settings.card_border_width }}px solid {{ block.settings.card_border_color }};
    border-radius: {{ block.settings.card_border_radius }}px;
    background: {{ block.settings.card_bg_color }};
    box-shadow: {{ block.settings.card_shadow_h }}px {{ block.settings.card_shadow_v }}px {{ block.settings.card_shadow_blur }}px rgba(0,0,0,{{ block.settings.card_shadow_opacity | divided_by: 100.0 }});
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .ai-product-card-{{ ai_gen_id }}:hover {
    transform: translateY(-2px);
    box-shadow: {{ block.settings.card_shadow_h }}px {{ block.settings.card_shadow_v | plus: 4 }}px {{ block.settings.card_shadow_blur | plus: 8 }}px rgba(0,0,0,{{ block.settings.card_shadow_opacity | divided_by: 100.0 | times: 1.5 }});
  }

  .ai-card-media-{{ ai_gen_id }} {
    position: relative;
    overflow: hidden;
    aspect-ratio: 1;
  }

  .ai-card-image-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: opacity 0.3s ease;
  }

  .ai-card-image-hover-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .ai-product-card-{{ ai_gen_id }}:hover .ai-card-image-hover-{{ ai_gen_id }} {
    opacity: 1;
  }

  .ai-product-card-{{ ai_gen_id }}:hover .ai-card-image-{{ ai_gen_id }} {
    opacity: 0;
  }

  .ai-card-content-{{ ai_gen_id }} {
    padding: 16px;
    text-align: left;
  }

  .ai-product-title-{{ ai_gen_id }} {
    font-size: 16px;
    font-weight: 600;
    margin: 0 0 8px;
    color: {{ block.settings.card_text_color }};
  }

  .ai-product-title-{{ ai_gen_id }} a {
    color: inherit;
    text-decoration: none;
  }

  .ai-product-description-{{ ai_gen_id }} {
    font-size: 14px;
    color: {{ block.settings.card_text_color }};
    opacity: 0.8;
    margin: 0 0 12px;
    line-height: 1.4;
  }

  .ai-product-price-{{ ai_gen_id }} {
    font-size: 18px;
    font-weight: 600;
    color: {{ block.settings.card_price_color }};
    margin: 0 0 12px;
  }

  .ai-color-swatches-{{ ai_gen_id }} {
    display: flex;
    gap: 6px;
    margin-top: 12px;
  }

  .ai-color-swatch-{{ ai_gen_id }} {
    width: {{ block.settings.swatch_size }}px;
    height: {{ block.settings.swatch_size }}px;
    border-radius: {{ block.settings.swatch_border_radius }}px;
    border: 2px solid {{ block.settings.swatch_border_color }};
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .ai-color-swatch-{{ ai_gen_id }}:hover {
    transform: scale(1.1);
    border-color: {{ block.settings.swatch_hover_border }};
  }

  .ai-pagination-{{ ai_gen_id }} {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin-top: 40px;
  }

  .ai-pagination-btn-{{ ai_gen_id }} {
    padding: 10px 16px;
    background: {{ block.settings.pagination_bg }};
    color: {{ block.settings.pagination_text }};
    border: 1px solid {{ block.settings.pagination_border }};
    border-radius: 4px;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .ai-pagination-btn-{{ ai_gen_id }}:hover,
  .ai-pagination-btn-{{ ai_gen_id }}.current {
    background: {{ block.settings.pagination_active_bg }};
    color: {{ block.settings.pagination_active_text }};
  }

  @media screen and (max-width: 990px) {
    .ai-collection-layout-{{ ai_gen_id }} {
      flex-direction: column;
    }
    
    .ai-sidebar-{{ ai_gen_id }} {
      width: 100%;
      display: none;
    }

    .ai-products-container-{{ ai_gen_id }} {
      grid-template-columns: repeat({{ block.settings.products_per_row_tablet }}, 1fr);
    }

    .ai-collection-meta-filters-{{ ai_gen_id }} {
      flex-direction: column;
      gap: 15px;
    }

    .ai-filter-navigation-{{ ai_gen_id }} {
      max-width: 100%;
    }

    .ai-meta-info-{{ ai_gen_id }} {
      justify-content: center;
    }
  }

  @media screen and (max-width: 749px) {
    .ai-products-container-{{ ai_gen_id }} {
      grid-template-columns: repeat(2, 1fr);
      gap: {{ block.settings.mobile_card_spacing }}px;
    }

    .ai-product-card-{{ ai_gen_id }} {
      margin-bottom: {{ block.settings.mobile_card_spacing }}px;
    }

    .ai-filter-buttons-{{ ai_gen_id }} {
      gap: 8px;
    }

    .ai-filter-btn-{{ ai_gen_id }} {
      padding: 8px 16px;
      font-size: 13px;
    }

    .ai-meta-info-{{ ai_gen_id }} {
      flex-direction: column;
      gap: 10px;
    }

    .ai-collection-title-{{ ai_gen_id }} {
      font-size: 2rem;
    }
  }



  
{% endstyle %}









{% style %}
/* --- Hard cap & center on desktop --- */
.ai-collection-container-{{ ai_gen_id }}{
  width: 100%;
  max-width: 1450px;
  margin-left: auto;
  margin-right: auto;
  padding-left: 20px;
  padding-right: 20px;
  box-sizing: border-box;
}

/* If you truly want a hard fixed width (not just max), lock it ≥ 1200px */
@media screen and (min-width: 1200px){
  .ai-collection-container-{{ ai_gen_id }}{
    width: 1450px !important;   /* force */
    max-width: none !important; /* ignore theme clamps */
  }
}

/* Mobile gutters */
@media screen and (max-width: 749px){
  .ai-collection-container-{{ ai_gen_id }}{
    padding-left: 16px;
    padding-right: 16px;
    width: 100%;
    max-width: 100%;
  }
}

/* (Important) Nuke the previous calc() rule so it never shrinks weirdly */
@media screen and (max-width: 1490px){
  .ai-collection-container-{{ ai_gen_id }}{
    width: auto;          /* reset */
    max-width: 1450px;    /* keep the cap */
  }
}

/* Optional: ensure inner layout never bleeds past 1450 */
.ai-collection-layout-{{ ai_gen_id }},
.ai-collection-meta-filters-{{ ai_gen_id }},
.ai-collection-header-{{ ai_gen_id }}{
  max-width: 1450px;
  margin-left: auto;
  margin-right: auto;
}
{% endstyle %}










<collection-page-{{ ai_gen_id }}
  class="ai-collection-container-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  {% if block.settings.show_collection_header %}
    <div class="ai-collection-header-{{ ai_gen_id }}">
      <h1 class="ai-collection-title-{{ ai_gen_id }}">{{ collection.title }}</h1>
      {% if collection.description != blank %}
        <div class="ai-collection-description-{{ ai_gen_id }}">{{ collection.description }}</div>
      {% endif %}
    </div>
  {% endif %}

  {% if collection.metafields.custom.sub_title %}
    <div class="ai-collection-meta-{{ ai_gen_id }}">
      {{ collection.metafields.custom.sub_title }}
    </div>
  {% endif %}

  <div class="ai-collection-meta-filters-{{ ai_gen_id }}">
    <div class="ai-filter-navigation-{{ ai_gen_id }}">
      <div class="ai-filter-buttons-{{ ai_gen_id }}">
        {% for link in linklists['main-menu'].links %}
          {% assign parent_link_title = link.title | handleize | downcase %}
          {% if parent_link_title == 'products' and link.links.size > 0 %}
            {% for sublink in link.links %}
              {% assign sublink_parts = sublink.url | split: '/' %}
              {% assign sublink_handle = sublink_parts | last %}
              {% if sublink_handle == collection.metafields.custom.parent_collection.value.handle
                or sublink_handle == collection.handle
              %}
                <a href="{{ sublink.url }}" class="ai-filter-btn-{{ ai_gen_id }} active">
                  <span>All {{ sublink.title }}</span>
                </a>
                {% if sublink.links.size > 0 %}
                  {% for subsublink in sublink.links %}
                    <a href="{{ subsublink.url }}" class="ai-filter-btn-{{ ai_gen_id }}">
                      <span>{{ subsublink.title }}</span>
                    </a>
                  {% endfor %}
                {% endif %}
              {% endif %}
            {% endfor %}
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <div class="ai-meta-info-{{ ai_gen_id }}">
      <div class="ai-meta-pill-{{ ai_gen_id }}">
        <svg class="ai-meta-icon-{{ ai_gen_id }}" viewBox="0 0 24 24" fill="currentColor">
          <path d="M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"/>
        </svg>
        <select class="ai-meta-select-{{ ai_gen_id }}">
          <option value="manual">Featured</option>
          <option value="price-ascending">Price: Low to High</option>
          <option value="price-descending">Price: High to Low</option>
          <option value="title-ascending">A-Z</option>
          <option value="title-descending">Z-A</option>
          <option value="created-ascending">Oldest</option>
          <option value="created-descending">Newest</option>
        </select>
      </div>

      <div class="ai-meta-pill-{{ ai_gen_id }}">
        <svg class="ai-meta-icon-{{ ai_gen_id }}" viewBox="0 0 24 24" fill="currentColor">
          <path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/>
        </svg>
        <select class="ai-meta-select-{{ ai_gen_id }}">
          <option value="12">12</option>
          <option value="24" selected>24</option>
          <option value="36">36</option>
          <option value="48">48</option>
        </select>
      </div>
    </div>
  </div>

  <div class="ai-collection-layout-{{ ai_gen_id }}">
    <div class="ai-sidebar-{{ ai_gen_id }}">
      {% if block.settings.show_categories %}
        <div class="ai-sidebar-section-{{ ai_gen_id }}">
          <div class="ai-sidebar-header-{{ ai_gen_id }}" onclick="toggleSidebar{{ ai_gen_id }}('categories')">
            <h3 class="ai-sidebar-title-{{ ai_gen_id }}">Categories</h3>
            <span class="ai-sidebar-toggle-{{ ai_gen_id }}" id="categories-toggle-{{ ai_gen_id }}">
              {% if block.settings.categories_default_open %}–{% else %}+{% endif %}
            </span>
          </div>
          <div class="ai-sidebar-content-{{ ai_gen_id }} {% unless block.settings.categories_default_open %}collapsed{% endunless %}" id="categories-content-{{ ai_gen_id }}">
            <ul class="ai-category-list-{{ ai_gen_id }} size-filter-ul facets-layout facets-layout-list facets-layout-list--text facets__list--vertical list-unstyled main-category-products">
              {% for collection in collections %}
                {% unless collection.handle == 'frontpage' %}
                  <li class="ai-category-item-{{ ai_gen_id }}">
                    <a href="{{ collection.url }}" class="ai-category-link-{{ ai_gen_id }}">
                      {{ collection.title }}
                    </a>
                  </li>
                {% endunless %}
              {% endfor %}
            </ul>
          </div>
        </div>
      {% endif %}

      {% if block.settings.show_price_filter %}
        <div class="ai-sidebar-section-{{ ai_gen_id }}">
          <div class="ai-sidebar-header-{{ ai_gen_id }}" onclick="toggleSidebar{{ ai_gen_id }}('price')">
            <h3 class="ai-sidebar-title-{{ ai_gen_id }}">Price Range</h3>
            <span class="ai-sidebar-toggle-{{ ai_gen_id }}" id="price-toggle-{{ ai_gen_id }}">
              {% if block.settings.price_default_open %}–{% else %}+{% endif %}
            </span>
          </div>
          <div class="ai-sidebar-content-{{ ai_gen_id }} {% unless block.settings.price_default_open %}collapsed{% endunless %}" id="price-content-{{ ai_gen_id }}">
            <div class="ai-price-inputs-{{ ai_gen_id }}">
              <input type="number" class="ai-price-input-{{ ai_gen_id }}" placeholder="Min" min="0">
              <span>-</span>
              <input type="number" class="ai-price-input-{{ ai_gen_id }}" placeholder="Max" min="0">
            </div>
          </div>
        </div>
      {% endif %}

      {% if block.settings.show_tags %}
        <div class="ai-sidebar-section-{{ ai_gen_id }}">
          <div class="ai-sidebar-header-{{ ai_gen_id }}" onclick="toggleSidebar{{ ai_gen_id }}('tags')">
            <h3 class="ai-sidebar-title-{{ ai_gen_id }}">Tags</h3>
            <span class="ai-sidebar-toggle-{{ ai_gen_id }}" id="tags-toggle-{{ ai_gen_id }}">
              {% if block.settings.tags_default_open %}–{% else %}+{% endif %}
            </span>
          </div>
          <div class="ai-sidebar-content-{{ ai_gen_id }} {% unless block.settings.tags_default_open %}collapsed{% endunless %}" id="tags-content-{{ ai_gen_id }}">
            <ul class="ai-tag-list-{{ ai_gen_id }}">
              {% for tag in collection.all_tags %}
                <li class="ai-tag-item-{{ ai_gen_id }}">{{ tag }}</li>
              {% endfor %}
            </ul>
          </div>
        </div>
      {% endif %}
    </div>

    <div class="ai-products-grid-{{ ai_gen_id }}">
      {% paginate collection.products by block.settings.products_per_page %}
        <div class="ai-products-container-{{ ai_gen_id }}">
          {% for product in collection.products %}
            <div class="ai-product-card-{{ ai_gen_id }}">
              <div class="ai-card-media-{{ ai_gen_id }}">
                <img
                  src="{{ product.featured_image | img_url: '500x' }}"
                  alt="{{ product.featured_image.alt | escape }}"
                  class="ai-card-image-{{ ai_gen_id }}"
                  data-product-id="{{ product.id }}"
                  loading="lazy"
                >
                {% if block.settings.show_hover_image and product.images[1] %}
                  <img
                    src="{{ product.images[1] | img_url: '500x' }}"
                    alt="{{ product.images[1].alt | escape }}"
                    class="ai-card-image-hover-{{ ai_gen_id }}"
                    loading="lazy"
                  >
                {% endif %}
              </div>

              <div class="ai-card-content-{{ ai_gen_id }}">
                <h3 class="ai-product-title-{{ ai_gen_id }}">
                  <a href="{{ product.url }}">{{ product.title }}</a>
                </h3>

                {% render 'junip-product-summary', product: product %}

                {% if product.metafields.custom.sub_title %}
                  <div class="ai-product-description-{{ ai_gen_id }}">
                    {{ product.metafields.custom.sub_title }}
                  </div>
                {% endif %}

                <div class="ai-product-price-{{ ai_gen_id }}">
                  From {{ product.price_min | money }}
                </div>

                {% if block.settings.show_color_swatches %}
                  <div class="ai-color-swatches-{{ ai_gen_id }}">
                    {% assign color_option = product.options_with_values | where: 'name', 'Color' | first %}
                    {% if color_option %}
                      {% for value in color_option.values %}
                        <input
                          type="radio"
                          name="color-{{ product.id }}"
                          value="{{ value | downcase }}"
                          class="color-radio"
                          data-product-id="{{ product.id }}"
                          style="display: none;"
                          {% if forloop.first %}checked{% endif %}
                        >
                        <label
                          for="color-{{ product.id }}-{{ forloop.index }}"
                          class="ai-color-swatch-{{ ai_gen_id }}"
                          style="background-color: {{ value | downcase }};"
                          title="{{ value }}"
                        ></label>
                      {% endfor %}
                    {% endif %}
                  </div>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        </div>

        {% if paginate.pages > 1 %}
          <div class="ai-pagination-{{ ai_gen_id }}">
            {% if paginate.previous %}
              <a href="{{ paginate.previous.url }}" class="ai-pagination-btn-{{ ai_gen_id }}">Previous</a>
            {% endif %}

            {% for part in paginate.parts %}
              {% if part.is_link %}
                <a href="{{ part.url }}" class="ai-pagination-btn-{{ ai_gen_id }}">{{ part.title }}</a>
              {% else %}
                <span class="ai-pagination-btn-{{ ai_gen_id }} current">{{ part.title }}</span>
              {% endif %}
            {% endfor %}

            {% if paginate.next %}
              <a href="{{ paginate.next.url }}" class="ai-pagination-btn-{{ ai_gen_id }}">Next</a>
            {% endif %}
          </div>
        {% endif %}
      {% endpaginate %}
    </div>
  </div>
</collection-page-{{ ai_gen_id }}>

<script>
(function() {
  window.toggleSidebar{{ ai_gen_id }} = function(section) {
    const content = document.getElementById(section + '-content-{{ ai_gen_id }}');
    const toggle = document.getElementById(section + '-toggle-{{ ai_gen_id }}');
    
    if (content && toggle) {
      content.classList.toggle('collapsed');
      toggle.textContent = content.classList.contains('collapsed') ? '+' : '–';
    }
  };
})();
</script>

{% schema %}
{
  "name": "Collection page",
  "settings": [
    {
      "type": "header",
      "content": "Collection header"
    },
    {
      "type": "checkbox",
      "id": "show_collection_header",
      "label": "Show collection header",
      "default": true
    },
    {
      "type": "color",
      "id": "header_text_color",
      "label": "Header text color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "color",
      "id": "section_background_color",
      "label": "Section background color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "layout_gap",
      "min": 20,
      "max": 60,
      "step": 5,
      "unit": "px",
      "label": "Layout gap",
      "default": 30
    },
    {
      "type": "range",
      "id": "products_per_row",
      "min": 2,
      "max": 5,
      "step": 1,
      "label": "Products per row (desktop)",
      "default": 4
    },
    {
      "type": "range",
      "id": "products_per_row_tablet",
      "min": 2,
      "max": 4,
      "step": 1,
      "label": "Products per row (tablet)",
      "default": 3
    },
    {
      "type": "range",
      "id": "products_per_page",
      "min": 12,
      "max": 48,
      "step": 12,
      "label": "Products per page",
      "default": 24
    },
    {
      "type": "header",
      "content": "Filter buttons"
    },
    {
      "type": "color",
      "id": "filter_button_bg",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "filter_button_text",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "filter_button_border",
      "label": "Border color",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "filter_button_hover_bg",
      "label": "Hover background color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "filter_button_hover_text",
      "label": "Hover text color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Meta information"
    },
    {
      "type": "color",
      "id": "meta_pill_bg",
      "label": "Background color",
      "default": "#f5f5f5"
    },
    {
      "type": "color",
      "id": "meta_pill_text",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "meta_pill_border",
      "label": "Border color",
      "default": "#e0e0e0"
    },
    {
      "type": "header",
      "content": "Sidebar"
    },
    {
      "type": "range",
      "id": "sidebar_width",
      "min": 200,
      "max": 350,
      "step": 10,
      "unit": "px",
      "label": "Sidebar width",
      "default": 280
    },
    {
      "type": "checkbox",
      "id": "show_categories",
      "label": "Show categories",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "categories_default_open",
      "label": "Categories open by default",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_price_filter",
      "label": "Show price filter",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "price_default_open",
      "label": "Price filter open by default",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_tags",
      "label": "Show tags",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "tags_default_open",
      "label": "Tags open by default",
      "default": false
    },
    {
      "type": "color",
      "id": "sidebar_bg_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "sidebar_text_color",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "sidebar_border_color",
      "label": "Border color",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "sidebar_header_bg",
      "label": "Header background color",
      "default": "#f8f8f8"
    },
    {
      "type": "color",
      "id": "sidebar_link_hover_color",
      "label": "Link hover color",
      "default": "#0066cc"
    },
    {
      "type": "range",
      "id": "sidebar_border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 8
    },
    {
      "type": "range",
      "id": "sidebar_section_spacing",
      "min": 10,
      "max": 40,
      "step": 5,
      "unit": "px",
      "label": "Section spacing",
      "default": 20
    },
    {
      "type": "range",
      "id": "sidebar_header_padding",
      "min": 10,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Header padding",
      "default": 16
    },
    {
      "type": "range",
      "id": "sidebar_content_padding",
      "min": 10,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Content padding",
      "default": 16
    },
    {
      "type": "range",
      "id": "category_item_spacing",
      "min": 2,
      "max": 15,
      "step": 1,
      "unit": "px",
      "label": "Category item spacing",
      "default": 6
    },
    {
      "type": "range",
      "id": "sidebar_shadow_h",
      "min": 0,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Shadow horizontal",
      "default": 0
    },
    {
      "type": "range",
      "id": "sidebar_shadow_v",
      "min": 0,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Shadow vertical",
      "default": 2
    },
    {
      "type": "range",
      "id": "sidebar_shadow_blur",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Shadow blur",
      "default": 8
    },
    {
      "type": "range",
      "id": "sidebar_shadow_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Shadow opacity",
      "default": 10
    },
    {
      "type": "header",
      "content": "Product cards"
    },
    {
      "type": "range",
      "id": "card_spacing",
      "min": 10,
      "max": 40,
      "step": 5,
      "unit": "px",
      "label": "Card spacing",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_card_spacing",
      "min": 8,
      "max": 24,
      "step": 4,
      "unit": "px",
      "label": "Mobile card spacing",
      "default": 12
    },
    {
      "type": "color",
      "id": "card_bg_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "card_text_color",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "card_price_color",
      "label": "Price color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "card_border_color",
      "label": "Border color",
      "default": "#e0e0e0"
    },
    {
      "type": "range",
      "id": "card_border_width",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "px",
      "label": "Border width",
      "default": 1
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 8
    },
    {
      "type": "range",
      "id": "card_shadow_h",
      "min": 0,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Shadow horizontal",
      "default": 0
    },
    {
      "type": "range",
      "id": "card_shadow_v",
      "min": 0,
      "max": 10,
      "step": 1,
      "unit": "px",
      "label": "Shadow vertical",
      "default": 2
    },
    {
      "type": "range",
      "id": "card_shadow_blur",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Shadow blur",
      "default": 8
    },
    {
      "type": "range",
      "id": "card_shadow_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Shadow opacity",
      "default": 10
    },
    {
      "type": "checkbox",
      "id": "show_hover_image",
      "label": "Show hover image",
      "default": true
    },
    {
      "type": "header",
      "content": "Color swatches"
    },
    {
      "type": "checkbox",
      "id": "show_color_swatches",
      "label": "Show color swatches",
      "default": true
    },
    {
      "type": "range",
      "id": "swatch_size",
      "min": 20,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Swatch size",
      "default": 24
    },
    {
      "type": "range",
      "id": "swatch_border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Swatch border radius",
      "default": 4
    },
    {
      "type": "color",
      "id": "swatch_border_color",
      "label": "Swatch border color",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "swatch_hover_border",
      "label": "Swatch hover border color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Tags"
    },
    {
      "type": "color",
      "id": "tag_bg_color",
      "label": "Background color",
      "default": "#f0f0f0"
    },
    {
      "type": "color",
      "id": "tag_text_color",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "tag_border_color",
      "label": "Border color",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "tag_hover_bg",
      "label": "Hover background color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "tag_hover_text",
      "label": "Hover text color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "tag_border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 12
    },
    {
      "type": "header",
      "content": "Pagination"
    },
    {
      "type": "color",
      "id": "pagination_bg",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "pagination_text",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "pagination_border",
      "label": "Border color",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "pagination_active_bg",
      "label": "Active background color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "pagination_active_text",
      "label": "Active text color",
      "default": "#ffffff"
    }
  ],
  "presets": [
    {
      "name": "Collection page"
    }
  ]
}
{% endschema %}