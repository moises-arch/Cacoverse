{%- assign product_media_slider_id = 'product-media-slider-' | append: product.id -%}

<div
  class="product-media-slider"
  role="region"
  aria-roledescription="carousel"
  aria-label="{{ product.title | escape }}"
>
  <div
    id="{{ product_media_slider_id }}"
    class="swiper-container"
    data-space-between="12"
    data-slides-desktop="1"
    data-slides-tablet="1"
    data-slides-mobile="1"
    data-loop="true"
  >
    <div class="swiper-wrapper pmedia" aria-live="polite">
      {% for media in product.media %}
        {%- assign is_first = forloop.first -%}
        <div class="swiper-slide" role="group" aria-label="{{ forloop.index }} de {{ product.media.size }}">
          {%- assign media_color_tokens = media.alt | downcase | split: ',' -%}
          {{ media | image_url: width: 1440 | image_tag: 
            class: 'img-fluid',
            widths: '375, 550, 750, 1100, 1440',
            sizes: '(min-width: 1024px) 50vw, 100vw',
            loading: is_first ? 'eager' : 'lazy',
            fetchpriority: is_first ? 'high' : 'auto',
            alt: media.alt | strip,
            data-color: (media_color_tokens | first | strip | handleize),
            data-color-list: (media.alt | downcase | strip | escape)
          }}
        </div>
      {% endfor %}
    </div>

    <div class="product-media-controls">
      <button
        type="button"
        class="swiper-button-prev product-media-nav"
        aria-label="Ver la imagen anterior"
        aria-controls="{{ product_media_slider_id }}"
      >
        <span aria-hidden="true">‹</span>
      </button>
      <button
        type="button"
        class="swiper-button-next product-media-nav"
        aria-label="Ver la siguiente imagen"
        aria-controls="{{ product_media_slider_id }}"
      >
        <span aria-hidden="true">›</span>
      </button>
    </div>
  </div>
</div>
