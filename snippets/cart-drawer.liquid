{% comment %}
  Renders cart drawer

  Usage:
  {% render 'cart-drawer' %}
{% endcomment %}

{{ 'quantity-popover.css' | asset_url | stylesheet_tag }}
{{ 'component-card.css' | asset_url | stylesheet_tag }}

<script src="{{ 'cart.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'quantity-popover.js' | asset_url }}" defer="defer"></script>

<style>


  .drawer {
    visibility: hidden;
  }

  /* --- CUSTOM STYLES: NAMESPACED (SCD) --- */
  :root {
    --scd-surface: #f5f7fb;
    --scd-soft: #ffffff;
    --scd-ink: #0f172a;
    --scd-ink-subtle: #5b6473;
    --scd-accent: #2050bc;
    --scd-accent-strong: #1b48aa;
    --scd-accent-soft: #e4ebfa;
    --scd-border: rgba(15, 23, 42, 0.08);
    --scd-border-strong: rgba(15, 23, 42, 0.12);
    --scd-card: #ffffff;
    --scd-shadow: 0 8px 24px rgba(15, 23, 42, 0.08);
    --scd-radius: 14px;
    --scd-skinny-radius: 10px;
    --scd-text-strong: #0b1222;
    --scd-chat-gap: 86px;
    --scd-rec-bg: linear-gradient(135deg, #f8fbff, #edf2ff);
  }

  /* General Variables Override */
  .cart-drawer {
    height: 100%;
  }

  .drawer__inner {
    background: var(--scd-surface);
    color: var(--scd-ink) !important;
    font-family: 'Inter', 'SF Pro Display', system-ui, -apple-system, sans-serif !important;
    -webkit-overflow-scrolling: touch;
    display: flex;
    flex-direction: column;
    height: 100%;
    min-height: 100%;
    overflow: hidden;
  }

  .drawer__header {
    padding: 18px 22px 12px;
    border-bottom: 1px solid var(--scd-border);
    background: #ffffff;
    position: sticky;
    top: 0;
    z-index: 3;
    backdrop-filter: blur(10px);
    margin-left: -16px;
    margin-right: -16px;
    width: calc(100% + 32px);
  }

  .drawer__heading {
    color: var(--scd-text-strong) !important;
    font-size: 23px !important;
    font-weight: 800;
    letter-spacing: -0.02em;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .scd-cart-count-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, var(--scd-accent), #4b76e0);
    color: #ffffff;
    font-size: 11px;
    font-weight: 700;
    height: 24px;
    width: 24px;
    border-radius: 50%;
    margin-left: 6px;
    box-shadow: 0 8px 18px rgba(37, 99, 235, 0.25);
  }

  /* Free Shipping Bar */
  .scd-shipping-bar {
    margin-left: -1rem;
    margin-right: -1rem;
    width: calc(100% + 2rem);
    background: linear-gradient(90deg, #e7edfb, #f5f8ff);
    border-bottom: 1px solid var(--scd-border);
  }
  .scd-shipping-bar__inner {
    padding: 12px 16px;
    display: grid;
    gap: 8px;
  }
  .scd-shipping-bar__row {
    display: grid;
    grid-template-columns: auto 1fr auto;
    gap: 12px;
    align-items: center;
  }
  .scd-shipping-bar__icon {
    width: 44px;
    height: 44px;
    border-radius: 999px;
    background: #fff;
    border: 1px solid var(--scd-border-strong);
    display: grid;
    place-items: center;
    color: var(--scd-accent);
  }
  .scd-shipping-bar__body {
    min-width: 0;
    display: grid;
    gap: 6px;
  }
  .scd-shipping-bar__msg {
    font-size: 14px;
    margin: 0;
    font-weight: 800;
    color: #24457a;
    line-height: 1.35;
    letter-spacing: -0.01em;
  }
  .scd-shipping-bar__note {
    margin: 0;
    font-size: 12px;
    color: #6b7280;
    line-height: 1.4;
  }
  .scd-shipping-chip {
    background: #e9f0ff;
    color: var(--scd-accent-strong);
    padding: 6px 12px;
    border-radius: 999px;
    font-size: 12px;
    font-weight: 800;
    border: 1px solid rgba(32, 80, 188, 0.2);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    white-space: nowrap;
  }
  .scd-progress-container {
    width: 100%;
    height: 8px;
    background: rgba(32, 80, 188, 0.12);
    border-radius: 999px;
    overflow: hidden;
    position: relative;
    border: 1px solid rgba(15, 23, 42, 0.06);
  }
  .scd-progress-fill {
    height: 100%;
    display: block;
    background: linear-gradient(90deg, #2050bc, #4b76e0);
    transition: width 0.35s ease-in-out;
    border-radius: 999px;
    min-width: 8px;
    transform: translateZ(0);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
  }

  /* Image Wrapper */
  .scd-item__image-wrapper {
    width: 118px !important;
    height: 118px !important;
    min-width: 118px !important;
    max-width: 118px !important;
    border: 1px solid var(--scd-border) !important;
    box-shadow: none !important;
    display: block;
    overflow: hidden;
    border-radius: var(--scd-radius) !important;
    background: #f8fafc;
  }

  /* Image: Fills the wrapper completely */
  .scd-item__image {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    display: block;
    border: none !important;
    box-shadow: none !important;
    transform: scale(1.01);
  }

  /* Item Card */
  .cart-items {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0 12px;
  }

  .cart-drawer__form {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
  }

  cart-drawer-items {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
  }

  .drawer__contents {
    flex: 1;
    min-height: 0;
    overflow-y: auto;
    padding: 14px 16px 0;
    margin: 0 -16px 0;
  }

  .cart-item {
    background: var(--scd-card) !important;
    border-radius: var(--scd-radius) !important;
    border: 1px solid var(--scd-border-strong) !important;
    box-shadow: none;
    transition: background-color 0.2s ease;
  }
  .cart-item:hover {
    background: #fbfcff;
  }

  .cart-items td {
    padding: 12px 14px;
    vertical-align: top;
  }

  /* Item Details Column */
  .scd-item__info {
    padding-left: 10px !important;
    vertical-align: top;
    position: relative;
    display: grid;
    grid-template-rows: auto auto 1fr auto;
    gap: 4px;
  }

  /* Remove Button */
  .scd-item__remove-btn {
    position: absolute;
    top: 8px;
    right: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #ffffff;
    border: 1px solid var(--scd-border);
    cursor: pointer;
    color: #475569;
    padding: 6px;
    border-radius: 10px;
    transition: all 0.2s;
    z-index: 10;
  }
  .scd-item__remove-btn:hover {
    color: #ef4444;
    background: #fff1f2;
  }

  /* Vendor */
  .scd-item__vendor {
    font-size: 11.5px;
    color: var(--scd-ink-subtle);
    text-transform: uppercase;
    letter-spacing: 0.06em;
    margin: 0;
    padding-right: 30px;
    line-height: 1;
  }

  /* Title */
  .scd-item__name {
    font-size: 16px;
    font-weight: 800;
    line-height: 1.3;
    color: var(--scd-ink);
    text-decoration: none;
    margin: 0 0 2px 0;
    display: block;
    padding-right: 32px;
  }

  /* Price Block */
  .scd-item__price-block {
    display: grid;
    grid-template-columns: 1fr auto;
    align-items: baseline;
    gap: 8px;
    margin: 4px 0 0;
    line-height: 1.1;
  }

  .scd-item__price-unit {
    font-size: 13px;
    color: var(--scd-ink-subtle) !important;
    opacity: 1;
  }

  .scd-item__price-unit--sale {
    color: #ef4444 !important;
    font-weight: 800;
  }

  .scd-item__price-subtotal {
    font-size: 17px;
    font-weight: 800;
    color: var(--scd-ink) !important;
    text-align: right;
  }

  .scd-item__price-compare {
     color: var(--scd-ink-subtle) !important;
     text-decoration: line-through;
     font-size: 12.8px;
     margin-left: 6px;
     font-weight: 600;
  }

  /* Options */
  .scd-item__option {
    font-size: 12.6px;
    color: var(--scd-ink-subtle);
    line-height: 1.2;
    margin: 0;
  }

  /* Discount Badge */
  .scd-item__discount {
    font-size: 11.4px;
    background: rgba(22, 163, 74, 0.08);
    padding: 2px 8px;
    border-radius: 8px;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    margin-top: 6px;
    color: #15803d;
    width: fit-content;
    font-weight: 700;
    border: 1px solid rgba(34, 197, 94, 0.2);
  }
  .scd-item__discount svg {
    width: 10px;
    height: 10px;
  }

  /* Quantity Row */
  .scd-item__qty-row {
    margin-top: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 14px;
    width: 100%;
  }

  .scd-qty-box {
    display: inline-flex;
    align-items: center;
    background: #f5f7fb;
    border-radius: 12px;
    padding: 0 4px;
    height: 34px !important;
    min-height: 0 !important;
    width: auto;
    border: 1px solid var(--scd-border-strong);
    box-shadow: none;
  }

  .scd-qty-box::after {
    content: none;
  }

  .scd-qty__btn {
    width: 30px;
    height: 100%;
    min-height: 0 !important;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    background: transparent;
    cursor: pointer;
    color: #0f172a;
    padding: 0;
    opacity: 0.8;
  }
  .scd-qty__btn:hover {
    opacity: 1;
  }

  .scd-qty__btn svg {
    width: 10px;
    height: 10px;
  }

  .scd-qty__input {
    width: 36px;
    height: 100%;
    min-height: 0 !important;
    border: none;
    background: transparent;
    text-align: center;
    font-weight: 800;
    font-size: 14px;
    color: var(--scd-ink);
    padding: 0;
    -moz-appearance: textfield;
  }
  .scd-qty__input:focus {
    outline: none;
    box-shadow: none;
  }

  /* DEFAULT FOOTER for Desktop fallback */
  .drawer__footer {
    position: sticky;
    bottom: 0;
    z-index: 3;
    padding: 0;
    margin: 0 -16px;
    width: calc(100% + 32px);
    background: transparent;
    box-shadow: none;
  }

  .cart-drawer__footer {
     padding: 10px 16px 4px;
  }

  /* Footer Elements */
  .scd-footer__summary {
    display: grid;
    gap: 8px;
    padding: 12px 14px 10px;
    background: #ffffff;
    border: 1px solid var(--scd-border-strong);
    border-radius: 12px;
    box-shadow: none;
    margin-bottom: 6px;
    color: var(--scd-ink);
  }

  .scd-footer__eyebrow {
    margin: 0;
    font-size: 11.5px;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--scd-ink-subtle);
    font-weight: 700;
  }

  .scd-footer__totals {
    margin: 0;
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    gap: 10px;
  }

  .scd-footer__total-label {
    font-size: 16px;
    font-weight: 800;
    color: var(--scd-ink);
    margin: 0;
    letter-spacing: -0.01em;
  }

  .scd-footer__total-value {
    font-size: 20px;
    font-weight: 900;
    color: var(--scd-ink);
    margin: 0;
  }

  .scd-footer__tax-note {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    font-size: 12.5px;
    color: var(--scd-ink-subtle);
    margin: 0;
    line-height: 1.35;
  }

  .scd-footer__note-icon {
    width: 16px;
    height: 16px;
    color: var(--scd-ink-subtle);
    flex-shrink: 0;
  }

  /* Buttons Layout */
  .scd-footer__actions {
    display: flex;
    gap: 10px;
    padding: 12px 14px calc(12px + var(--scd-safe-area-bottom));
    padding-right: calc(14px + var(--scd-chat-gap));
    flex-direction: column;
    position: sticky;
    bottom: 0;
    background: #ffffff;
    box-shadow: 0 -6px 18px rgba(15, 23, 42, 0.08);
    border-top: 1px solid var(--scd-border);
    box-sizing: border-box;
    margin: 0;
  }

  @media screen and (min-width: 768px) {
    .scd-footer__actions {
       flex-direction: row;
    }

    .cart-drawer__footer {
       padding: 14px 16px 8px;
    }
  }

  .scd-btn {
    display: flex;
    flex: 1;
    justify-content: center;
    align-items: center;
    padding: 0 16px !important;
    height: 46px !important;
    min-height: 46px !important;
    max-height: 46px !important;
    background: linear-gradient(135deg, var(--scd-accent), #4b76e0);
    color: #ffffff;
    border-radius: 12px;
    font-weight: 800;
    font-size: 15px;
    text-decoration: none;
    border: 1px solid transparent;
    cursor: pointer;
    transition: transform 0.12s ease, box-shadow 0.12s ease;
    margin-bottom: 0;
    gap: 8px;
    text-transform: none;
    letter-spacing: 0.01em;
    box-sizing: border-box !important;
    line-height: 1 !important;
    box-shadow: 0 10px 22px rgba(37, 99, 235, 0.18);
  }

  .scd-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 12px 26px rgba(37, 99, 235, 0.22);
  }

  .scd-btn--secondary {
    background: #ffffff;
    color: var(--scd-accent);
    border: 1px solid rgba(32, 80, 188, 0.28);
    box-shadow: none;
  }
  .scd-btn--secondary:hover {
    transform: translateY(-1px);
    box-shadow: 0 8px 18px rgba(15, 23, 42, 0.1);
  }

  @media screen and (min-width: 768px) {
    .scd-btn--secondary {
      display: flex;
    }
  }

  /* Reassurance list */
  .scd-reassurance {
    margin-top: 12px;
    display: grid;
    gap: 10px;
  }
  .scd-reassurance__item {
    display: grid;
    grid-template-columns: 44px 1fr;
    gap: 12px;
    align-items: center;
    padding: 12px 14px;
    border-radius: 14px;
    border: 1px solid rgba(14, 159, 110, 0.18);
    background: linear-gradient(135deg, #f3fcf6, #eef8f1);
    color: var(--scd-ink);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.7);
  }
  .scd-reassurance__icon {
    width: 44px;
    height: 44px;
    border-radius: 14px;
    background: #e9f7ef;
    color: #0f9b50;
    display: grid;
    place-items: center;
    border: 1px solid rgba(15, 155, 80, 0.26);
    box-shadow: 0 8px 14px rgba(15, 155, 80, 0.1);
  }
  .scd-reassurance__title {
    font-weight: 800;
    margin: 0;
    font-size: 14px;
    color: var(--scd-ink);
    line-height: 1.3;
  }
  .scd-reassurance__copy {
    margin: 3px 0 0;
    font-size: 12.8px;
    color: var(--scd-ink-subtle);
    line-height: 1.4;
  }

  /* Recommendations */
  .scd-recs {
    margin: 16px 0 0;
    padding: 14px 0 6px;
    border-top: 1px solid var(--scd-border);
  }

  .scd-recs.is-empty {
    display: none;
  }

  .scd-recs__header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 0 2px 12px;
    gap: 10px;
  }

  .scd-recs__title {
    margin: 0;
    font-size: 15px;
    font-weight: 800;
    letter-spacing: -0.01em;
    color: var(--scd-ink);
  }

  .scd-recs__note {
    margin: 0;
    font-size: 12px;
    color: var(--scd-ink-subtle);
    text-align: right;
  }

  .scd-recs__list {
    display: grid;
    gap: 10px;
  }

  .scd-rec {
    display: grid;
    grid-template-columns: 74px 1fr auto;
    gap: 12px;
    align-items: center;
    padding: 10px 12px;
    background: var(--scd-rec-bg);
    border-radius: 12px;
    border: 1px solid var(--scd-border-strong);
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.65);
  }

  .scd-rec__image-wrap {
    width: 74px;
    height: 74px;
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid var(--scd-border);
    background: #f8fafc;
  }

  .scd-rec__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .scd-rec__body {
    display: grid;
    gap: 4px;
    min-width: 0;
  }

  .scd-rec__name {
    margin: 0;
    font-size: 14px;
    font-weight: 800;
    color: var(--scd-ink);
    line-height: 1.3;
  }

  .scd-rec__price {
    margin: 0;
    font-size: 13px;
    color: var(--scd-ink-subtle);
  }
















.scd-rec__actions {
  display: flex;
  align-items: center;
  justify-content: flex-end;
}

.scd-rec__btn {
  border-radius: 999px;
  min-width: 80px;
  height: 32px;
  padding: 0 14px;
  border: 1px solid transparent;
  background: linear-gradient(135deg, var(--scd-accent), #4b76e0);
  color: #ffffff;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 11.5px;
  font-weight: 700;
  cursor: pointer;
  transition:
    box-shadow 0.15s ease,
    transform 0.15s ease,
    background-color 0.15s ease,
    border-color 0.15s ease;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  white-space: nowrap;
  box-shadow: 0 8px 18px rgba(37, 99, 235, 0.18);
}

.scd-rec__btn:hover {
  box-shadow: 0 10px 22px rgba(37, 99, 235, 0.22);
  transform: translateY(-1px);
}

.scd-rec__btn[disabled] {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}











.scd-recs__more-btn {
  margin: 8px 4px 2px;
  border: none;
  background: transparent;
  color: var(--scd-ink-subtle);
  font-size: 12px;
  cursor: pointer;
  padding: 4px 0 0;
  text-align: left;
}

.scd-recs__more-btn:hover {
  color: var(--scd-accent);
  text-decoration: underline;
}










.cart-item.scd-cart-item--just-added {
  animation: scd-cart-fade-in 0.45s ease-out;
}

@keyframes scd-cart-fade-in {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}










  .scd-rec__skeleton {
    height: 84px;
    border-radius: 12px;
    background: linear-gradient(90deg, #f1f5f9 25%, #e2e8f0 50%, #f1f5f9 75%);
    background-size: 200% 100%;
    animation: scd-skeleton 1.2s ease-in-out infinite;
  }

  @keyframes scd-skeleton {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }

  .drawer__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .drawer__close {
    margin-right: 18px;
  }

  :root {
    --scd-safe-area-bottom: env(safe-area-inset-bottom, 0px);
  }

  @supports(padding: max(0px)) {
    :root {
      --scd-safe-area-bottom: max(env(safe-area-inset-bottom, 0px), 0px);
    }
  }

  /* Mobile polish */
  @media screen and (max-width: 767px) {
    .drawer__header {
      padding: 18px 20px 12px;
      margin-left: -12px;
      margin-right: -12px;
      width: calc(100% + 24px);
    }
  }

    .drawer__footer {
      margin: 0 -12px;
      width: calc(100% + 24px);
    }

    .drawer__contents {
      padding: 10px 12px 0;
      margin: 0 -12px 0;
    }

    .drawer__close {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      padding: 10px;
      margin-right: 18px;
    }

    .drawer__close .svg-wrapper {
      width: 18px;
      height: 18px;
    }

    .scd-shipping-bar__row {
      grid-template-columns: auto 1fr;
      grid-template-rows: auto auto;
    }

    .scd-shipping-chip {
      display: none !important;
    }

    .cart-items {
      border-spacing: 0 12px;
    }

    .cart-items td {
      padding: 10px 10px;
    }

    .scd-recs {
      margin-top: 10px;
    }

    .scd-rec {
      grid-template-columns: 68px 1fr auto;
      padding: 10px 10px;
    }

    .scd-rec__image-wrap {
      width: 68px;
      height: 68px;
    }

    .scd-item__image-wrapper {
      width: 130px !important;
      height: 130px !important;
      min-width: 130px !important;
      max-width: 130px !important;
    }

    .scd-item__info {
      padding-left: 4px !important;
      gap: 3px;
    }

    .scd-item__name {
      font-size: 15.5px;
      line-height: 1.25;
    }

    .scd-item__price-block {
      grid-template-columns: 1fr;
      gap: 6px;
      align-items: flex-start;
    }

    .scd-item__price-subtotal {
      text-align: left;
      display: block;
    }

    .scd-item__qty-row {
      flex-wrap: wrap;
    }

    .scd-footer__actions {
      position: sticky;
      bottom: 0;
      left: 0;
      right: 0;
      background: #ffffff;
      padding: 12px 18px calc(14px + var(--scd-safe-area-bottom));
      padding-right: calc(18px + var(--scd-chat-gap));
      margin: 0;
      box-shadow: 0 -8px 20px rgba(15, 23, 42, 0.12);
      z-index: 8;
    }

    .cart-drawer__footer {
      padding: 12px 18px 6px;
    }

    .scd-footer__summary {
      padding: 10px 12px 8px;
      border-radius: 10px;
      box-shadow: none;
      margin-bottom: 6px;
    }

    .scd-btn {
      height: 52px !important;
      min-height: 52px !important;
      max-height: 52px !important;
      box-shadow: none;
    }

    .scd-btn--secondary {
      display: none !important;
    }

    .scd-reassurance {
      margin-bottom: calc(8px + var(--scd-safe-area-bottom));
    }
  }
</style>

<cart-drawer class="drawer{% if cart == empty %} is-empty{% endif %}">
  <div id="CartDrawer" class="cart-drawer">
    <div id="CartDrawer-Overlay" class="cart-drawer__overlay"></div>
    <div
      class="drawer__inner gradient color-{{ settings.cart_color_scheme }}"
      role="dialog"
      aria-modal="true"
      aria-label="{{ 'sections.cart.title' | t }}"
      tabindex="-1"
    >
      {%- if cart == empty -%}
        <div class="drawer__inner-empty">
          <div class="cart-drawer__warnings center{% if settings.cart_drawer_collection != blank %} cart-drawer__warnings--has-collection{% endif %}">
            <div class="cart-drawer__empty-content">
              <h2 class="cart__empty-text">{{ 'sections.cart.empty' | t }}</h2>
              <button
                class="drawer__close"
                type="button"
                onclick="this.closest('cart-drawer').close()"
                aria-label="{{ 'accessibility.close' | t }}"
              >
                <span class="svg-wrapper">
                  {{- 'icon-close.svg' | inline_asset_content -}}
                </span>
              </button>
              <a href="{{ routes.all_products_collection_url }}" class="scd-btn">
                {{ 'general.continue_shopping' | t }}
              </a>
            </div>
          </div>
        </div>
      {%- endif -%}
      
      <div class="drawer__header">
        <h2 class="drawer__heading">
          {{ 'sections.cart.title' | t }}
          {% if cart.item_count > 0 %}
            <span class="scd-cart-count-badge">{{ cart.item_count }}</span>
          {% endif %}
        </h2>
        <button
          class="drawer__close"
          type="button"
          onclick="this.closest('cart-drawer').close()"
          aria-label="{{ 'accessibility.close' | t }}"
        >
          <span class="svg-wrapper">
            {{- 'icon-close.svg' | inline_asset_content -}}
          </span>
        </button>
      </div>

      <div
        id="CartDrawer-AvailabilityMessage"
        class="cart-drawer__notice"
        role="status"
        aria-live="polite"
      >
        <div class="cart-drawer__notice-icon" aria-hidden="true">!</div>
        <div class="cart-drawer__notice-body">
          <p class="cart-drawer__notice-text"></p>
          <div class="cart-drawer__notice-progress" aria-hidden="true">
            <span class="cart-drawer__notice-bar"></span>
          </div>
        </div>
      </div>

      {% assign free_shipping_goal = 10000 %}
      {% assign cart_total = cart.total_price %}
      {% assign shipping_progress = cart_total | times: 100 | divided_by: free_shipping_goal %}
      {% assign shipping_progress = shipping_progress | at_least: 0 | at_most: 100 %}
      {% assign shipping_remaining = free_shipping_goal | minus: cart_total | at_least: 0 %}

      {% if cart.item_count > 0 %}
        <div class="scd-shipping-bar" role="status">
          <div class="scd-shipping-bar__inner">
            <div class="scd-shipping-bar__row">
              <div class="scd-shipping-bar__icon" aria-hidden="true">
                <svg width="26" height="26" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M3 9a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12H7a2 2 0 0 1-2-2Z" />
                  <path d="M19 13h5.2a2 2 0 0 1 1.7.93l2.1 3.33V21a2 2 0 0 1-2 2h-2" />
                  <path d="M7 25a2 2 0 1 1 0-4 2 2 0 0 1 0 4Z" />
                  <path d="M23 25a2 2 0 1 1 0-4 2 2 0 0 1 0 4Z" />
                  <path d="M9 15h6" />
                  <path d="M8 17.5 9.2 19H15" />
                </svg>
              </div>
              <div class="scd-shipping-bar__body">
                <p class="scd-shipping-bar__msg">
                  {% if cart_total >= free_shipping_goal %}
                    You're eligible for free shipping!
                  {% else %}
                    Add {{ shipping_remaining | money_with_currency }} to unlock free shipping.
                  {% endif %}
                </p>
                <div
                  class="scd-progress-container"
                  role="progressbar"
                  aria-valuemin="0"
                  aria-valuemax="100"
                  aria-valuenow="{{ shipping_progress }}"
                  aria-label="Free shipping progress"
                >
                  {% assign progress_width = shipping_progress | append: '%' %}
                  <span class="scd-progress-fill" style="width: {{ progress_width }}"></span>
                </div>
                <p class="scd-shipping-bar__note">Applies to subtotal before taxes and discounts.</p>
              </div>
              <div class="scd-shipping-chip">
                {% if cart_total >= free_shipping_goal %}
                  Free shipping unlocked
                {% else %}
                  {{ shipping_progress | round: 0 }}% to goal
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      {% endif %}
      
      <cart-drawer-items
        {% if cart == empty %}
          class=" is-empty"
        {% endif %}
      >
        <form
          action="{{ routes.cart_url }}"
          id="CartDrawer-Form"
          class="cart__contents cart-drawer__form"
          method="post"
        >
          <div id="CartDrawer-CartItems" class="drawer__contents js-contents">
            {%- if cart != empty -%}
              <div class="drawer__cart-items-wrapper">














                <table class="cart-items" role="table">
                  <thead role="rowgroup">
                    <tr role="row">
                      <th id="CartDrawer-ColumnProductImage" role="columnheader">
                        <span class="visually-hidden">{{ 'sections.cart.headings.image' | t }}</span>
                      </th>
                      <th
                        id="CartDrawer-ColumnProduct"
                        class="caption-with-letter-spacing"
                        scope="col"
                        role="columnheader"
                      >
                        {{ 'sections.cart.headings.product' | t }}
                      </th>
                    </tr>
                  </thead>

                  <tbody role="rowgroup">
                    {%- for item in cart.items -%}
                      <tr id="CartDrawer-Item-{{ item.index | plus: 1 }}" class="cart-item" role="row">
                        <td class="cart-item__media" role="cell" headers="CartDrawer-ColumnProductImage">
                          {% if item.image %}
                            <a href="{{ item.url }}" class="cart-item__link" tabindex="-1" aria-hidden="true"> </a>
                            <div class="scd-item__image-wrapper">
                              <img
                                class="cart-item__image scd-item__image"
                                src="{{ item.image | image_url: width: 180, format: 'webp' }}"
                                alt="{{ item.image.alt | escape }}"
                                loading="lazy"
                                width="180"
                                height="180"
                              >
                            </div>
                          {% endif %}
                        </td>

                        <td class="cart-item__details scd-item__info" role="cell" headers="CartDrawer-ColumnProduct">
                          
                          <cart-remove-button id="CartDrawer-Remove-{{ item.index | plus: 1 }}" data-index="{{ item.index | plus: 1 }}">
                            <button type="button" class="scd-item__remove-btn" aria-label="Remove" data-variant-id="{{ item.variant.id }}">
                              <span class="svg-wrapper">{{- 'icon-remove.svg' | inline_asset_content -}}</span>
                            </button>
                          </cart-remove-button>

                          {%- if settings.show_vendor -%}
                            <p class="scd-item__vendor">{{ item.product.vendor }}</p>
                          {%- endif -%}

                          <a href="{{ item.url }}" class="scd-item__name">
                            {{- item.product.title | escape -}}
                          </a>

                          <!-- PRICE BLOCK: UNIT + SUBTOTAL -->
                          {%- liquid
                            assign item_compare_at = item.variant.compare_at_price
                            assign item_is_on_sale = false
                            if item_compare_at > item.final_price
                              assign item_is_on_sale = true
                            endif
                          -%}

                          <div class="scd-item__price-block">
                            <div class="scd-item__price-unit{% if item_is_on_sale %} scd-item__price-unit--sale{% endif %}">
                              {{ item.final_price | money }} each
                              {%- if item_is_on_sale -%}
                                <s class="scd-item__price-compare">{{ item_compare_at | money }}</s>
                              {%- endif -%}
                            </div>
                            <div class="scd-item__price-subtotal">
                              {{ item.final_line_price | money }}
                            </div>
                          </div>

                          {%- if item.product.has_only_default_variant == false
                            or item.properties.size != 0
                            or item.selling_plan_allocation != null
                          -%}
                            <dl>
                              {%- if item.product.has_only_default_variant == false -%}
                                {%- for option in item.options_with_values -%}
                                  <div class="scd-item__option">
                                    <dt style="display:inline">{{ option.name }}:</dt>
                                    <dd style="display:inline; margin:0">
                                      {{ option.value -}}
                                      {%- unless forloop.last %}, {% endunless %}
                                    </dd>
                                  </div>
                                {%- endfor -%}
                              {%- endif -%}

                              {%- if item.selling_plan_allocation != null -%}
                                <div class="scd-item__option subscription-frequency-tag mt-1 d-flex align-items-center" style="color: #1761A2; font-weight: 600; font-size: 0.85rem; background: rgba(23, 97, 162, 0.08); padding: 2px 8px; border-radius: 4px; width: fit-content;">
                                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px;"><path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/></svg>
                                  <span>{{ item.selling_plan_allocation.selling_plan.name }}</span>
                                </div>
                              {%- endif -%}

                              {%- for property in item.properties -%}
                                {%- assign property_first_char = property.first | slice: 0 -%}
                                {%- if property.last != blank and property_first_char != '_' -%}
                                  <div class="scd-item__option">
                                    <dt style="display:inline">{{ property.first }}:</dt>
                                    <dd style="display:inline; margin:0">
                                      {%- if property.last contains '/uploads/' -%}
                                        <a href="{{ property.last }}" target="_blank">
                                          {{ property.last | split: '/' | last }}
                                        </a>
                                      {%- else -%}
                                        {{ property.last }}
                                      {%- endif -%}
                                    </dd>
                                  </div>
                                {%- endif -%}
                              {%- endfor -%}
                            </dl>
                          {%- endif -%}

                          <ul class="discounts list-unstyled" role="list">
                            {%- for discount in item.line_level_discount_allocations -%}
                              <li class="scd-item__discount">
                                {{- 'icon-discount.svg' | inline_asset_content -}}
                                {{ discount.discount_application.title }}
                              </li>
                            {%- endfor -%}
                          </ul>

                          <!-- Quantity Row -->
                           <div class="scd-item__qty-row">
                              <quantity-popover>
                                <div class="cart-item__quantity-wrapper quantity-popover-wrapper">
                                  <div class="quantity-popover-container scd-qty-container">
                                    <quantity-input class="quantity scd-qty-box">
                                      <button class="quantity__button scd-qty__btn" name="minus" type="button">
                                        <span class="visually-hidden">{{ 'products.product.quantity.decrease' | t: product: item.product.title | escape }}</span>
                                        <span class="svg-wrapper">{{- 'icon-minus.svg' | inline_asset_content -}}</span>
                                      </button>
                                      <input
                                        class="quantity__input scd-qty__input"
                                        type="number"
                                        data-quantity-variant-id="{{ item.variant.id }}"
                                        name="updates[]"
                                        value="{{ item.quantity }}"
                                        data-cart-quantity="{{ cart | item_count_for_variant: item.variant.id }}"
                                        min="0"
                                        step="1"
                                        aria-label="{{ 'products.product.quantity.input_label' | t: product: item.product.title | escape }}"
                                        id="Drawer-quantity-{{ item.index | plus: 1 }}"
                                        data-index="{{ item.index | plus: 1 }}"
                                      >
                                      <button class="quantity__button scd-qty__btn" name="plus" type="button">
                                        <span class="visually-hidden">{{ 'products.product.quantity.increase' | t: product: item.product.title | escape }}</span>
                                        <span class="svg-wrapper">{{- 'icon-plus.svg' | inline_asset_content -}}</span>
                                      </button>
                                    </quantity-input>
                                  </div>
                                </div>
                              </quantity-popover>
                           </div>

                        </td>
                      </tr>
                    {%- endfor -%}
                  </tbody>
                </table>



{%- if cart.item_count > 0 -%}
  <!-- IDs de productos del carrito para que el JS pueda pedir recomendaciones -->
  <script id="CartDrawer-ProductIds" type="application/json">
    {{ cart.items | map: 'product' | map: 'id' | json }}
  </script>

  <!-- Recomendaciones dentro del cart drawer -->
<section class="scd-recs is-empty" id="CartDrawer-Recs" aria-label="You might also like">
  <div class="scd-recs__header">
    <h3 class="scd-recs__title">Complete your order</h3>
    <p class="scd-recs__note">Suggestions based on your cart</p>
  </div>
  <div class="scd-recs__list">
    <div class="scd-rec__skeleton"></div>
    <div class="scd-rec__skeleton"></div>
  </div>
  <button
    type="button"
    class="scd-recs__more-btn"
    hidden
  >
    View more suggestions
  </button>
</section>

{%- endif -%}





















                <div class="scd-reassurance" aria-label="Checkout benefits">
                  <div class="scd-reassurance__item">
                    <div class="scd-reassurance__icon" aria-hidden="true">
                      <svg width="20" height="20" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M16 28c-4.4-1.6-8-4.6-8-9.5V9.4a2 2 0 0 1 1.1-1.8l6.3-3a2 2 0 0 1 1.6 0l6.3 3a2 2 0 0 1 1.1 1.8v9.1C24 23.4 20.4 26.4 16 28Z" />
                        <path d="m12.5 16.5 2.8 2.5 4.2-5" />
                      </svg>
                    </div>
                    <div>
                      <p class="scd-reassurance__title">Secure checkout</p>
                      <p class="scd-reassurance__copy">Bank-level encryption and verified payments keep you protected.</p>
                    </div>
                  </div>
                  <div class="scd-reassurance__item">
                    <div class="scd-reassurance__icon" aria-hidden="true">
                      <svg width="20" height="20" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M16 4v6" />
                        <path d="M16 18v2" />
                        <path d="M10.5 28A11.5 11.5 0 1 1 27.5 16h-5" />
                        <path d="m17.5 21.5 2.5-4.5" />
                        <path d="m13 13.5 3-5.5" />
                      </svg>
                    </div>
                    <div>
                      <p class="scd-reassurance__title">Fast processing</p>
                      <p class="scd-reassurance__copy">Priority handling means your order moves in hours, not days.</p>
                    </div>
                  </div>
                </div>








              </div>
            {%- endif -%}
            <p id="CartDrawer-LiveRegionText" class="visually-hidden" role="status"></p>
            <p id="CartDrawer-LineItemStatus" class="visually-hidden" aria-hidden="true" role="status">
              {{ 'accessibility.loading' | t }}
            </p>
          </div>
          <div id="CartDrawer-CartErrors" role="alert"></div>
        </form>
      </cart-drawer-items>

      <div class="drawer__footer">
        <div class="cart-drawer__footer" {{ block.shopify_attributes }}>
          <div class="scd-footer__summary" role="status">
            <p class="scd-footer__eyebrow">Order summary</p>
            <div class="scd-footer__totals">
              <h2 class="scd-footer__total-label">{{ 'sections.cart.estimated_total' | t }}</h2>
              <p class="scd-footer__total-value">{{ cart.total_price | money_with_currency }}</p>
            </div>
            <p class="scd-footer__tax-note caption-large rte">
              <span class="scd-footer__note-icon" aria-hidden="true">{{- 'icon-info.svg' | inline_asset_content -}}</span>
              <span>Taxes and shipping calculated at checkout</span>
            </p>
          </div>
        </div>

        <div class="scd-footer__actions">
          <a href="{{ routes.cart_url }}" class="scd-btn scd-btn--secondary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
            View Cart
          </a>
          <button type="submit" id="CartDrawer-Checkout" class="scd-btn" name="checkout" form="CartDrawer-Form">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            {{ 'sections.cart.checkout' | t }}
          </button>
        </div>

      </div>
    </div>
  </div>
</cart-drawer>
