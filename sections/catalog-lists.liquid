{% style %}
  #shopify-section-{{ section.id }}{
    padding-top: {{ section.settings.padding_top_desktop }};
    padding-bottom: {{ section.settings.padding_bottom_desktop }};
  }

  @media( max-width: 767px){
     #shopify-section-{{ section.id }}{
      padding-top: {{ section.settings.padding_top_mobile }};
      padding-bottom: {{ section.settings.padding_bottom_mobile }};
    }
  }
{% endstyle %}
{{ 'calalog-lists.css' | asset_url | stylesheet_tag }}
<div class="page-width container-fluid">
  <div class="row">
    <div class="col-12 catalog-list-heading">
      <div class="collection-hero__description rte" id="description">
        {{ section.settings.description }}
      </div>

      <a href="javascript:void(0);" id="toggle-desc" onclick="toggleDescription()">Show More</a>

      <script>
        function toggleDescription() {
          const desc = document.getElementById('description');
          const toggleBtn = document.getElementById('toggle-desc');

          if (toggleBtn.textContent === 'Show More') {
            desc.innerHTML = fullHtml;
            toggleBtn.textContent = 'Show Less';
          } else {
            showShortDesc();
            toggleBtn.textContent = 'Show More';
          }
        }

        // Save full description html on page load
        const desc = document.getElementById('description');
        const fullHtml = desc.innerHTML;

        function showShortDesc() {
          const parser = new DOMParser();
          const doc = parser.parseFromString(fullHtml, 'text/html');
          const paragraphs = doc.body.querySelectorAll('p');
          let shortHtml = '';
          for (let i = 0; i < Math.min(1, paragraphs.length); i++) {
            shortHtml += paragraphs[i].outerHTML;
          }
          desc.innerHTML = shortHtml;
        }

        // Show short description initially
        showShortDesc();
      </script>
      <style>
        #toggle-desc{
          color: var(--secondar-hover-color);
          text-decoration: none;
          padding: 20px 0;
          display: block;
        }

        #toggle-desc:hover{
          text-decoration: underline;
        }
      </style>
    </div>
  </div>
  <div class="row mt-5 mt-md-5">
    {% for block in section.blocks %}
      <div class="col-sm-6 col-md-4 mb-3 mb-md-5">
        <div class="catalog-list-box d-flex flex-column gap-3">
          <div class="imager">
            <img
              src="{{ block.settings.image | img_url : 'master'  }}"
              class="img-fluid"
              width="{{  block.settings.image.width }}"
              height="{{  block.settings.image.height }}"
              loading="lazy"
            >
          </div>
          <h3 class="sh-32">
            {{ block.settings.heading }}
            {% render 'arrow-icon' %}
          </h3>
          {{ block.settings.description }}
          <a class="s-btn" href="{{ block.settings.link }}" title="Learn More">
            <span>{{ block.settings.link_label }}</span>
          </a>
        </div>
      </div>
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "Catalog Lists",
  "class": "catalog-lists",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "richtext",
      "id": "description",
      "label": "Heading",
    },
    {
      "type": "text",
      "id": "padding_top_desktop",
      "label": "Padding Desktop Top",
      "default": "80px"
    },
     {
      "type": "text",
      "id": "padding_bottom_desktop",
      "label": "Padding Desktop Bottom",
      "default": "80px"
    },
     {
      "type": "text",
      "id": "padding_top_mobile",
      "label": "Padding Mobile Top",
      "default": "40px"
    },
     {
      "type": "text",
      "id": "padding_bottom_mobile",
      "label": "Padding Mobile Bottom",
      "default": "40px"
    },
  ],
  "blocks": [
    {
      "type": "catalog_list",
      "name": "catalog List",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Select Image",
        },
         {
          "type": "text",
          "id": "heading",
          "label": "Heading",
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Discription",
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link",
        },
          {
          "type": "text",
          "id": "link_label",
          "label": "Link Label",
        },
      ]
    }
  ],
  "presets": [
    {
      "name": "Catalog Lists",
    }
  ]
}
{% endschema %}
