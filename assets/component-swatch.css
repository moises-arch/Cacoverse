/* ==========================================================
   SWATCHES — PREMIUM “EXECUTIVE OVERRIDE”
   Single-file drop-in for Dawn-like themes
   Goal: visibly rounded swatches (even if theme fights back)
   Paste this WHOLE file and make sure it loads AFTER theme CSS.
   ========================================================== */

/* ---------------------------
   0) TOKENS (easy tuning)
   --------------------------- */
:root {
  --swatch-size: 44px;          /* inner color square */
  --swatch-gap: 10px;           /* space between chips */
  --swatch-radius: 16px;        /* main rounding (try 18px / 999px) */
  --swatch-pad: 5px;            /* padding inside chip around swatch */
  --swatch-border: 1.6px;       /* chip border thickness */

  --swatch-bg: #ffffff;
  --swatch-bg-hover: #f8fafc;
  --swatch-bg-active: #f0f7fb;

  --swatch-line: rgba(17, 24, 39, 0.18);
  --swatch-line-hover: rgba(13, 107, 166, 0.55);
  --swatch-accent: #0d6ba6;

  --swatch-shadow: 0 1px 0 rgba(17, 24, 39, 0.05);
  --swatch-shadow-hover: 0 10px 24px rgba(17, 24, 39, 0.10);
  --swatch-ring: 0 0 0 2px rgba(13, 107, 166, 0.16);
  --swatch-ring-strong: 0 0 0 2px rgba(13, 107, 166, 0.22), 0 0 0 4px rgba(13, 107, 166, 0.08);

  --swatch-tooltip-bg: rgba(17, 24, 39, 0.92);
  --swatch-tooltip-text: #fff;
}

/* ---------------------------------------------------------
   1) PDP WRAPPER + LAYOUT (tight, clean, consistent)
   --------------------------------------------------------- */
.product-form__input--swatch {
  /* Dawn token: set it here so everything downstream inherits */
  --swatch-input--size: var(--swatch-size) !important;
  --swatch-input--border-radius: var(--swatch-radius) !important;
  --swatch-border-width: var(--swatch-border) !important;

  display: flex !important;
  flex-wrap: wrap !important;
  gap: var(--swatch-gap) !important;
  align-items: center !important;
}

/* Legend spacing polish */
.product-form__input--swatch legend {
  margin-bottom: 6px !important;
}

/* ---------------------------------------------------------
   2) CHIP (the visible frame) — this is what you’re seeing
   --------------------------------------------------------- */
.product-form__input--swatch .swatch-input__input + .swatch-input__label {
  /* HARD WIN — no more “square” */
  border-radius: var(--swatch-input--border-radius) !important;
  overflow: hidden !important;

  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;

  padding: var(--swatch-pad) !important;
  background: var(--swatch-bg) !important;

  border: var(--swatch-border-width) solid var(--swatch-line) !important;
  box-shadow: var(--swatch-shadow) !important;

  position: relative !important;
  cursor: pointer !important;
  user-select: none !important;

  transform: translateZ(0) !important;
  transition:
    border-color .16s ease,
    background-color .16s ease,
    box-shadow .16s ease,
    transform .12s ease !important;
}

/* Make the chip slightly “button-like” on hover (desktop only) */
@media (hover: hover) and (pointer: fine) {
  .product-form__input--swatch .swatch-input__input + .swatch-input__label:hover,
  .product-form__input--swatch .swatch-input__input:hover + .swatch-input__label {
    background: var(--swatch-bg-hover) !important;
    border-color: var(--swatch-line-hover) !important;
    box-shadow: var(--swatch-shadow-hover), var(--swatch-ring) !important;
    transform: translateY(-1px) !important;
  }
}

/* Selected = “approved by leadership” ring */
.product-form__input--swatch .swatch-input__input:checked + .swatch-input__label {
  background: var(--swatch-bg-active) !important;
  border-color: var(--swatch-accent) !important;
  box-shadow: var(--swatch-shadow-hover), var(--swatch-ring-strong) !important;
}

/* Press micro-interaction */
.product-form__input--swatch .swatch-input__input:active + .swatch-input__label,
.product-form__input--swatch .swatch-input__input + .swatch-input__label:active {
  transform: translateY(0) !important;
  box-shadow: var(--swatch-shadow), var(--swatch-ring) !important;
}

/* Accessible focus */
.product-form__input--swatch .swatch-input__input:focus-visible + .swatch-input__label {
  outline: 0 !important;
  border-color: var(--swatch-accent) !important;
  box-shadow: var(--swatch-shadow-hover), var(--swatch-ring-strong) !important;
}

/* ---------------------------------------------------------
   3) SWATCH (the inner color square/image)
   --------------------------------------------------------- */
.product-form__input--swatch .swatch {
  width: var(--swatch-input--size) !important;
  aspect-ratio: 1 / 1 !important;
  display: block !important;

  background: var(--swatch--background) !important;
  background-position: var(--swatch-focal-point, center) !important;
  background-size: cover !important;
  background-origin: border-box !important;

  border: 0 !important; /* kill theme border, we own the frame */
  border-radius: calc(var(--swatch-input--border-radius) - var(--swatch-pad)) !important;
}

/* Theme sometimes forces "square" — we overrule */
.product-form__input--swatch .swatch--square {
  border-radius: calc(var(--swatch-input--border-radius) - var(--swatch-pad)) !important;
}

/* If the theme uses pseudo elements, keep them clipped too */
.product-form__input--swatch .swatch-input__input + .swatch-input__label::before,
.product-form__input--swatch .swatch-input__input + .swatch-input__label::after {
  border-radius: inherit !important;
}

/* ---------------------------------------------------------
   4) UNAVAILABLE — premium “slash” + reduced contrast
   --------------------------------------------------------- */
.product-form__input--swatch .swatch--unavailable {
  opacity: 0.55 !important;
  filter: grayscale(0.2) !important;
}

/* If label indicates disabled (many themes do), style it */
.product-form__input--swatch .swatch-input__label[aria-disabled="true"] {
  cursor: not-allowed !important;
  opacity: 0.9 !important;
}

/* Slash overlay (supports modern browsers with :has) */
.product-form__input--swatch .swatch-input__label:has(.swatch--unavailable)::after,
.product-form__input--swatch .swatch-input__label[aria-disabled="true"]::after {
  content: "" !important;
  position: absolute !important;
  inset: 6px !important;

  border-radius: calc(var(--swatch-input--border-radius) - 6px) !important;
  pointer-events: none !important;

  background:
    linear-gradient(135deg,
      transparent 46%,
      rgba(17, 24, 39, 0.28) 48%,
      rgba(17, 24, 39, 0.28) 52%,
      transparent 54%) !important;
}

/* Fallback if :has not supported: dashed inner outline */
@supports not selector(:has(*)) {
  .product-form__input--swatch .swatch--unavailable {
    outline: 1px dashed rgba(17, 24, 39, 0.35) !important;
    outline-offset: -1px !important;
  }
}

/* ---------------------------------------------------------
   5) TOOLTIP — tiny, centered, premium
   --------------------------------------------------------- */
.product-form__input--swatch .swatch-input__label[data-tooltip]::before,
.product-form__input--swatch .swatch-input__label[data-tooltip]::after {
  position: absolute !important;
  left: 50% !important;
  opacity: 0 !important;
  visibility: hidden !important;
  transform: translate(-50%, 6px) !important;
  transition: opacity .15s ease, transform .18s ease !important;
  pointer-events: none !important;
  z-index: 10 !important;
}

.product-form__input--swatch .swatch-input__label[data-tooltip]::after {
  content: attr(data-tooltip) !important;
  bottom: calc(100% + 10px) !important;
  padding: 5px 10px !important;
  background: var(--swatch-tooltip-bg) !important;
  color: var(--swatch-tooltip-text) !important;
  font-size: 11px !important;
  font-weight: 700 !important;
  letter-spacing: .2px !important;
  border-radius: 999px !important;
  white-space: nowrap !important;
  line-height: 1.1 !important;
  box-shadow: 0 10px 24px rgba(0,0,0,.16) !important;
}

.product-form__input--swatch .swatch-input__label[data-tooltip]::before {
  content: "" !important;
  bottom: calc(100% + 3px) !important;
  width: 10px !important;
  height: 10px !important;
  background: var(--swatch-tooltip-bg) !important;
  clip-path: polygon(50% 100%, 0 0, 100% 0) !important;
}

@media (hover: hover) and (pointer: fine) {
  .product-form__input--swatch .swatch-input__label[data-tooltip]:hover::before,
  .product-form__input--swatch .swatch-input__label[data-tooltip]:hover::after {
    opacity: 1 !important;
    visibility: visible !important;
    transform: translate(-50%, 0) !important;
  }
}

/* Show tooltip on keyboard focus too */
.product-form__input--swatch .swatch-input__input:focus-visible + .swatch-input__label[data-tooltip]::before,
.product-form__input--swatch .swatch-input__input:focus-visible + .swatch-input__label[data-tooltip]::after {
  opacity: 1 !important;
  visibility: visible !important;
  transform: translate(-50%, 0) !important;
}

/* ---------------------------------------------------------
   6) MOTION SAFETY
   --------------------------------------------------------- */
@media (prefers-reduced-motion: reduce) {
  .product-form__input--swatch .swatch-input__input + .swatch-input__label,
  .product-form__input--swatch .swatch-input__label[data-tooltip]::before,
  .product-form__input--swatch .swatch-input__label[data-tooltip]::after {
    transition: none !important;
  }
}

/* ---------------------------------------------------------
   7) OPTIONAL: If theme wraps swatches elsewhere, enforce radius
   (keeps things consistent in dropdown swatches too)
   --------------------------------------------------------- */
.swatch,
.swatch--square {
  border-radius: var(--swatch-radius) !important;
}
